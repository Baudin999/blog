<!DOCTYPE html>
<html lang="en"><!--
 __  __                __                                     __
/\ \/\ \              /\ \             __                    /\ \
\ \ \_\ \   __  __    \_\ \      __   /\_\      __       ___ \ \ \/'\
 \ \  _  \ /\ \/\ \   /'_` \   /'__`\ \/\ \   /'__`\    /'___\\ \ , <
  \ \ \ \ \\ \ \_\ \ /\ \L\ \ /\  __/  \ \ \ /\ \L\.\_ /\ \__/ \ \ \\`\
   \ \_\ \_\\/`____ \\ \___,_\\ \____\ _\ \ \\ \__/.\_\\ \____\ \ \_\ \_\
    \/_/\/_/ `/___/> \\/__,_ / \/____//\ \_\ \\/__/\/_/ \/____/  \/_/\/_/
                /\___/                \ \____/
                \/__/                  \/___/

Powered by Hydejack v9.1.6 <https://hydejack.com/>
-->







<head>
  






  
    

<title>Luanti | Carlos's Blog</title>
<meta name="description" content="Programmeren me Luanti (Minetest), een leerboek voor programmeurs van 10 tot 12.
(EN) Programming with Luanti (Minetest), in Dutch
">
<link rel="canonical" href="https://baudin999.github.io/blog//blog/2025/03/23/luanti.html">

  

  



  <meta name="color-scheme" content="dark light">



  <meta name="theme-color" content="rgb(45, 16, 9)">


<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">

<meta name="mobile-web-app-capable" content="yes">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="Carlos's Blog">
<meta name="apple-mobile-web-app-status-bar-style" content="default">

<meta name="application-name" content="Carlos's Blog">

<meta name="generator" content="Hydejack v9.2.1" />


<link rel="alternate" href="https://baudin999.github.io/blog//blog/2025/03/23/luanti.html" hreflang="en">

<link type="application/atom+xml" rel="alternate" href="https://baudin999.github.io/blog//blog/feed.xml" title="Carlos&apos;s Blog" />


<link rel="shortcut icon"    href="/blog/assets/icons/favicon.ico">
<link rel="apple-touch-icon" href="/blog/assets/icons/icon-192x192.png">

<link rel="manifest" href="/blog/assets/site.webmanifest">





<link rel="preload" href="/blog/assets/img/swipe.svg" as="image" id="_hrefSwipeSVG">






<script>((r,a)=>{function d(e,t,n,o){e.addEventListener?e.addEventListener(t,n,o):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}r.loadJS=function(e,t){var n=a.createElement("script"),e=(n.src=e,t&&d(n,"load",t,{once:!0}),a.scripts[0]);return e.parentNode.insertBefore(n,e),n},r._loaded=!1,r.loadJSDeferred=function(e,t){var n=a.createElement("script");function o(){r._loaded=!0,t&&d(n,"load",t,{once:!0});var e=a.scripts[0];e.parentNode.insertBefore(n,e)}return n.src=e,r._loaded?o():d(r,"load",o,{once:!0}),n},r.setRel=r.setRelStylesheet=function(e){d(a.getElementById(e),"load",function(){this.rel="stylesheet"},{once:!0})}})(window,document);
!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);
!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);
!function(w) {
  w._baseURL = '/blog/';
  w._publicPath = '/blog/assets/js/';
  w._noPushState = false;
  w._noDrawer = false;
  w._noNavbar = false;
  w._noToc = false;
  w._noSearch = false;
  w._search = {
    DATA_URL: '/blog/assets/sitedata.json?no-cache',
    STORAGE_KEY: 'mini-search/blog/',
    INDEX_KEY: 'index--2025-03-27T06:56:04+01:00',
  };
  w._clapButton = true;
}(window);</script>



<!--[if gt IE 8]><!---->

  




<link rel="stylesheet" href="/blog/assets/css/hydejack-9.2.1.css" id="_stylePreload">
<link rel="stylesheet" href="/blog/assets/icomoon/style.css" id="_iconsPreload">




  <style id="_pageStyle">

html{--accent-color: rgb(45, 16, 9);--accent-color-faded: rgba(45, 16, 9, 0.5);--accent-color-highlight: rgba(45, 16, 9, 0.1);--accent-color-darkened: rgb(13.125, 4.6666666667, 2.625);--theme-color: rgb(45, 16, 9);--dark-mode-body-bg: hsl(11.6666666667, 8.3333333333%, 17.5%);--dark-mode-border-color: hsl(11.6666666667, 8.3333333333%, 22.5%)}
</style>


<!--<![endif]-->





</head>

<body class="dark-mode no-break-layout">
  
<script>
  window._sunrise = 60;
  window._sunset =  180;
  ((e,s)=>{var d="light-mode",a="dark-mode",o=(new Date).getHours();"matchMedia"in e&&e.matchMedia("(prefers-color-scheme)")||(e=(o=o<=e._sunrise||o>=e._sunset?a:d)==a?d:a,s.body.classList.add(o),s.body.classList.remove(e))})(window,document);

</script>



<hy-push-state
  id="_pushState"
  replace-selector="#_main"
  link-selector="a[href]:not([href^='/blog/assets/']):not(.external):not(.no-push-state)"
  script-selector="script"
  duration="500"
  hashchange
>
  
  
  <div id="_navbar" class="navbar fixed-top">
  <div class="content">
    <span class="sr-only">Jump to:</span>
    <div class="nav-btn-bar">
      <a id="_menu" class="nav-btn no-hover" href="#_drawer--opened">
        <span class="sr-only">Navigation</span>
        <span class="icon-menu"></span>
      </a>
      <div class="nav-span"></div>
    </div>
  </div>
</div>
<hr class="sr-only" hidden />

  <main
  id="_main"
  class="content layout-post"
  role="main"
>
  <nav id="breadcrumbs" class="screen-only"><ul>
  
  
    <li><a href="/blog/">home</a></li>
    
      <li>
        
          <span>/</span>
          
          
          <a href="/blog/2025/">2025</a>
        
      </li>
    
      <li>
        
          <span>/</span>
          
          
          <a href="/blog/2025/03/">03</a>
        
      </li>
    
      <li>
        
          <span>/</span>
          
          
          <a href="/blog/2025/03/23/">23</a>
        
      </li>
    
      <li>
        
          <span>/</span>
          <span>luanti.html</span>
        
      </li>
    
  
</ul></nav>
  










<article id="post-2025-03-23-luanti" class="page post mb6" role="article">
  <header>
    <h1 class="post-title flip-project-title">
      
        Luanti
      
    </h1>

    <div class="post-date">
      
      <span class="ellipsis mr1">
        <time datetime="2025-03-23T00:00:00+01:00">23 Mar 2025</time>  on <span>Software</span>, <span>Development,</span>, <span>Gaming</span>
      </span>
      
        
      
    </div>

    
    

    



  <div class="hr pb0"></div>


  </header>

  
    <p>Programmeren me Luanti (Minetest), een leerboek voor programmeurs van 10 tot 12.<br />
(EN) Programming with Luanti (Minetest), in Dutch</p>

<h1 id="programmeren-met-luanti-minetest--leerboek-voor-jonge-programmeurs-10-12-jaar">Programmeren met Luanti (Minetest) – Leerboek voor jonge programmeurs (10-12 jaar)</h1>

<p><em>Welkom bij het leerboek <strong>Programmeren met Luanti</strong>! Luanti (voorheen bekend als Minetest) is een open source bouw- en ontdekspel, net als Minecraft, maar waarin je ook zelf nieuwe dingen kunt toevoegen via <strong>mods</strong>. In dit boek ga je stap voor stap leren hoe je zulke mods kunt maken. We doen dit met leuke, eenvoudige voorbeelden. We gaan bijvoorbeeld een mod maken om van modder een diamant te craften, toverdrankjes brouwen om te vliegen of langzaam neer te dalen, speciale armor maken die je krachten geeft, gekke zwaarden creëren en zelfs je eigen statistiek op het scherm tonen. Tot slot leer je hoe je jouw mods samen met vriend(inn)en op een lokaal netwerk kunt spelen. Je hoeft Lua (de programmeertaal van Luanti) niet van tevoren te kennen – je leert al doende door de code over te typen, uit te proberen en aan te passen. We leggen alles vriendelijk en duidelijk uit. Veel plezier en succes!</em></p>

<hr />

<h2 id="hoofdstuk-1-wat-is-een-mod">Hoofdstuk 1: Wat is een mod?</h2>

<p><strong>Wat ga je leren?</strong> In dit hoofdstuk leer je wat een <em>mod</em> is en hoe je er zelf een kunt maken. We laten de basisstructuur van een mod zien en schrijven een heel eenvoudige eerste mod. Je leert waar je de bestanden neerzet en hoe je de mod in het spel kunt testen. We eindigen met een paar kleine experimentjes om zelf uit te proberen.</p>

<h3 id="wat-is-een-mod">Wat is een mod?</h3>

<p>Een <strong>mod</strong> (afkorting van <em>modificatie</em>) is een aanvulling op het spel die door spelers zelf gemaakt is. In Luanti/Minetest kun je met mods bijna alles in het spel aanpassen of uitbreiden: nieuwe blokken en items toevoegen, recepten verzinnen, het gedrag van de speler veranderen, noem maar op. Mods worden geschreven in de programmeertaal <strong>Lua</strong>. Gelukkig is Lua eenvoudig en hoef je niet alles ervan te kennen om met mods te beginnen. We gaan je door voorbeelden laten zien hoe het werkt.</p>

<p>Stel je een mod voor als een <strong>map</strong> (folder) met daarin bestanden die de code en andere data (zoals plaatjes voor nieuwe items) bevatten. Als je Luanti opstart en je mod inschakelt, zal het spel jouw Lua-code uitvoeren en zo de veranderingen in het spel laden.</p>

<h3 id="de-structuur-van-een-mod">De structuur van een mod</h3>

<p>Een mod heeft minimaal twee dingen nodig:</p>
<ul>
  <li>Een <strong>map</strong> met de naam van je mod. Bijvoorbeeld: <code class="language-plaintext highlighter-rouge">welkom_mod</code>. (Kies een duidelijke naam zonder spaties. Deze naam wordt de modnaam.)</li>
  <li>In die map een bestand <strong><code class="language-plaintext highlighter-rouge">init.lua</code></strong>. Hierin komt de Lua-code van je mod. Luanti voert dit automatisch uit wanneer de mod geladen wordt.</li>
  <li>(Optioneel) een bestand <strong><code class="language-plaintext highlighter-rouge">mod.conf</code></strong> voor informatie over je mod, zoals de naam en afhankelijkheden.</li>
</ul>

<p>Je kunt meerdere bestanden en submappen hebben (bijv. een <code class="language-plaintext highlighter-rouge">textures</code> map voor afbeeldingen), maar <code class="language-plaintext highlighter-rouge">init.lua</code> is altijd het startpunt.</p>

<p><strong>Voorbeeld bestandsstructuur van een simpele mod:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>welkom_mod/         &lt;- Dit is de mod map (naam van de mod)
├── init.lua        &lt;- Hier komt de Lua-code
└── mod.conf        &lt;- Info over de mod (naam, afhankelijkheden, etc.)
</code></pre></div></div>

<p>In <code class="language-plaintext highlighter-rouge">mod.conf</code> zetten we meestal ten minste de naam van de mod. Bijvoorbeeld:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>name = welkom_mod
</code></pre></div></div>

<h3 id="onze-eerste-mod-een-welkomstbericht">Onze eerste mod: een welkomstbericht</h3>

<p>Laten we een hele simpele mod maken die een bericht in de chat laat zien zodra je de wereld betreedt. Zo kun je meteen testen of je mod werkt.</p>

<p>Open Visual Studio Code (VSCode) en maak de map voor je mod (bijv. <code class="language-plaintext highlighter-rouge">welkom_mod</code>). Maak daarin de bestanden <code class="language-plaintext highlighter-rouge">mod.conf</code> en <code class="language-plaintext highlighter-rouge">init.lua</code>. Vul <code class="language-plaintext highlighter-rouge">mod.conf</code> zoals hierboven (met <code class="language-plaintext highlighter-rouge">name = welkom_mod</code>). Schrijf daarna de volgende code in <code class="language-plaintext highlighter-rouge">init.lua</code>:</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Stuur een welkomstbericht naar iedere speler die het spel betreedt</span>
<span class="n">minetest</span><span class="p">.</span><span class="n">register_on_joinplayer</span><span class="p">(</span><span class="k">function</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
    <span class="kd">local</span> <span class="n">naam</span> <span class="o">=</span> <span class="n">player</span><span class="p">:</span><span class="n">get_player_name</span><span class="p">()</span>              <span class="c1">-- De gebruikersnaam van de speler</span>
    <span class="n">minetest</span><span class="p">.</span><span class="n">chat_send_player</span><span class="p">(</span><span class="n">naam</span><span class="p">,</span> <span class="s2">"Welkom "</span> <span class="o">..</span> <span class="n">naam</span> <span class="o">..</span> <span class="s2">" in Luanti!"</span><span class="p">)</span>  <span class="c1">-- Stuur bericht</span>
<span class="k">end</span><span class="p">)</span>
</code></pre></div></div>

<p>Zo, dat is je eerste stukje mod-code! Laten we even kort doornemen wat het doet:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">minetest.register_on_joinplayer(...)</code> registreert een functie die wordt aangeroepen telkens als een speler de wereld binnenkomt. In ons geval hebben we een anonieme functie <code class="language-plaintext highlighter-rouge">function(player) ... end</code> die een bericht stuurt.</li>
  <li><code class="language-plaintext highlighter-rouge">player:get_player_name()</code> haalt de naam van de speler op die zojuist is verschenen.</li>
  <li><code class="language-plaintext highlighter-rouge">minetest.chat_send_player(naam, "Welkom ...")</code> stuurt een chatbericht naar die speler. We plakken met <code class="language-plaintext highlighter-rouge">..</code> de spelersnaam achter het woord “Welkom “.</li>
</ul>

<p>Je hoeft dit nu nog niet allemaal te begrijpen – belangrijker is dat je ziet <em>wat</em> het doet. Kopieer de code precies over en sla het bestand op.</p>

<h3 id="testen-in-minetest">Testen in Minetest</h3>

<p>Nu gaan we je mod uitproberen in het spel. Volg deze stappen:</p>

<ol>
  <li><strong>Plaats de mod in de mods-folder:</strong> Zorg dat de map <code class="language-plaintext highlighter-rouge">welkom_mod</code> in de <code class="language-plaintext highlighter-rouge">mods</code> directory van Minetest/Luanti staat. (Als je Minetest Game speelt, kun je de mod ook in de <code class="language-plaintext highlighter-rouge">mods</code> map van die game zetten.) Dit heb je waarschijnlijk al gedaan toen je de map aanmaakte.</li>
  <li><strong>Activeer de mod:</strong> Start Luanti en ga naar <em>Start Game</em> (Een nieuw spel beginnen of een wereld selecteren). Kies de wereld waarin je wilt testen (of maak een nieuwe wereld). Klik op <em>Configure</em> of <em>Select Mods</em> voor die wereld en zorg dat jouw mod <code class="language-plaintext highlighter-rouge">welkom_mod</code> aangevinkt is. Start dan de wereld.</li>
  <li><strong>Bekijk het resultaat:</strong> Wanneer je wereld geladen is, zou er in de chat links onderin een bericht moeten staan, bijvoorbeeld: “Welkom speler1 in Luanti!” (als jouw spelernaam speler1 is).</li>
</ol>

<p>Als je dit bericht ziet, is je mod succesvol geladen en uitgevoerd! Gefeliciteerd, je hebt je eerste mod gemaakt 🎉.</p>

<p><em>Krijg je geen bericht te zien?</em> Controleer of je de mod geactiveerd hebt voor de wereld. Als dat zo is, sluit Minetest en kijk of er foutmeldingen in de terminal of debug.txt staan – misschien staat er een typefout in je code. Je kunt ook proberen via de chat de opdracht <code class="language-plaintext highlighter-rouge">/mods</code> te typen; het spel laat dan zien welke mods actief zijn in de wereld. Staat jouw mod ertussen?</p>

<h3 id="verwijzing-naar-documentatie">Verwijzing naar documentatie</h3>

<p>Wil je meer weten over dit soort basisfuncties? Je kunt in de officiële documentatie zoeken naar termen als <strong><code class="language-plaintext highlighter-rouge">register_on_joinplayer</code></strong> en <strong><code class="language-plaintext highlighter-rouge">chat_send_player</code></strong> (zoek bijvoorbeeld op <em>Minetest modding API on_joinplayer</em>). Daar vind je uitleg over alle functies die je kunt gebruiken.</p>

<h3 id="oefeningen">Oefeningen</h3>

<p>Probeer nu zelf het volgende om nog meer te leren:</p>

<ol>
  <li><strong>Bericht aanpassen:</strong> Pas de tekst van het welkomstbericht aan. Laat bijvoorbeeld een andere groet zien of voeg iets toe, zoals “Veel plezier!” achter de naam. Start het spel opnieuw en zie of het werkt.</li>
  <li><strong>Extra bericht na een tijdje:</strong> Kun jij de mod zo aanpassen dat hij niet alleen meteen begroet, maar bijvoorbeeld 5 seconden later nóg een bericht stuurt? (Tip: Zoek in de API documentatie naar iets als <em>“Minetest after delay”</em> of kijk of er een functie bestaat zoals <code class="language-plaintext highlighter-rouge">minetest.after</code> waarmee je code na een paar seconden kunt laten uitvoeren.)</li>
  <li><strong>Eigen idee:</strong> Bedenk een andere eenvoudige actie die gebeurt als je de wereld start. Bijvoorbeeld een geluid afspelen of een item geven. Probeer het uit door in de API te zoeken (bijv. zoek op <em>“Minetest give item to player”</em> voor het geven van een item). Experimenteer gerust – zo leer je het beste!</li>
</ol>

<p>Als je deze oefeningen doet, begin je al echt te programmeren. Wees niet bang om iets fout te doen; als er een fout is, geeft het spel dat meestal aan. Pas de code aan en probeer opnieuw. <strong>Goed gedaan tot nu toe!</strong> In het volgende hoofdstuk gaan we een stapje verder en iets tastbaars toevoegen aan het spel: we maken een eigen craft-recept.</p>

<hr />

<h2 id="hoofdstuk-2-een-simpele-crafting-mod-2-dirt--1-diamant">Hoofdstuk 2: Een simpele crafting-mod (2× dirt = 1 diamant)</h2>

<p><strong>Wat ga je leren?</strong> In dit hoofdstuk leer je hoe je een eigen crafting-recept toevoegt aan het spel. We maken een mod waardoor je van 2 blokken dirt (modder) een diamant kunt maken. Hiermee leer je hoe je items en recepten registreert. We laten de modstructuur zien en natuurlijk de code die je kunt overnemen. Daarna testen we het recept in het spel. Ten slotte geven we je wat oefenideeën, zoals het maken van je eigen recepten.</p>

<h3 id="modstructuur-voor-het-crafting-recept">Modstructuur voor het crafting-recept</h3>

<p>Maak een nieuwe mod map voor dit project, bijvoorbeeld <code class="language-plaintext highlighter-rouge">dirt_to_diamond</code>. Deze mod zal één Lua-script bevatten (init.lua) en een mod.conf. In mod.conf zetten we de mod-naam en geven we aan dat we het standaard spel (<code class="language-plaintext highlighter-rouge">default</code> items) gaan gebruiken:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dirt_to_diamond/
├── init.lua
└── mod.conf
</code></pre></div></div>

<p>In <code class="language-plaintext highlighter-rouge">mod.conf</code> schrijf je bijvoorbeeld:</p>
<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="py">name</span> <span class="p">=</span> <span class="s">dirt_to_diamond</span>
<span class="py">depends</span> <span class="p">=</span> <span class="s">default</span>
</code></pre></div></div>
<p>We zetten <code class="language-plaintext highlighter-rouge">depends = default</code> om zeker te zijn dat de standaard items (zoals dirt en diamant) geladen zijn voordat onze mod geladen wordt.</p>

<h3 id="code-een-craft-recept-registreren">Code: een craft-recept registreren</h3>

<p>Open <code class="language-plaintext highlighter-rouge">init.lua</code> in je <code class="language-plaintext highlighter-rouge">dirt_to_diamond</code> folder en typ de volgende code over:</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Registreer een nieuw craft-recept: 2x dirt -&gt; 1x diamond</span>
<span class="n">minetest</span><span class="p">.</span><span class="n">register_craft</span><span class="p">({</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s2">"default:diamond"</span><span class="p">,</span>        <span class="c1">-- Wat krijg je (1 diamant uit de default mod)</span>
    <span class="n">recipe</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">{</span><span class="s2">"default:dirt"</span><span class="p">,</span> <span class="s2">"default:dirt"</span><span class="p">}</span>   <span class="c1">-- Wat stop je erin: 2 dirt naast elkaar</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre></div></div>

<p>Laten we dit begrijpen:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">minetest.register_craft({...})</code> voegt een recept toe. We geven het in een tabel met eigenschappen.</li>
  <li><code class="language-plaintext highlighter-rouge">output = "default:diamond"</code> betekent dat het resultaat van het recept één standaard diamant is. (In Minetest worden items vaak aangeduid als <code class="language-plaintext highlighter-rouge">modnaam:itemnaam</code>. Diamant zit in de <code class="language-plaintext highlighter-rouge">default</code> mod en heet <code class="language-plaintext highlighter-rouge">diamond</code>, dus samen <code class="language-plaintext highlighter-rouge">default:diamond</code>.)</li>
  <li><code class="language-plaintext highlighter-rouge">recipe = { {"default:dirt", "default:dirt"} }</code> beschrijft de vorm van de ingrediënten. Hier gebruiken we een 2D-array die de crafting grid voorstelt. We hebben één rij met twee kolommen opgegeven: twee keer <code class="language-plaintext highlighter-rouge">default:dirt</code> naast elkaar. Dat betekent dat je in het 3×3 crafting veld twee dirt-blokken naast elkaar moet plaatsen (in dezelfde rij) om het recept te laten kloppen. De rest van de plekken mogen leeg zijn.</li>
</ul>

<blockquote>
  <p><strong>Tip:</strong> Je kunt ook <em>shapeless</em> recepten maken (waarbij de positie niet uitmaakt). Dan zou je <code class="language-plaintext highlighter-rouge">type = "shapeless"</code> toevoegen en de ingrediënten in een enkelvoudige lijst zetten. Maar in dit voorbeeld houden we het bij een vormgebonden recept.</p>
</blockquote>

<h3 id="testen-in-minetest-1">Testen in Minetest</h3>

<ol>
  <li><strong>Mod installeren:</strong> Zorg dat de folder <code class="language-plaintext highlighter-rouge">dirt_to_diamond</code> (met init.lua en mod.conf erin) in de mods map staat.</li>
  <li><strong>Mod activeren:</strong> Start Luanti en activeer de mod voor een testwereld (net zoals je deed in Hoofdstuk 1, via de mod-selectie van de wereld).</li>
  <li><strong>Voorwerpen verzamelen:</strong> Omdat we een recept testen, is het leuk om <em>niet</em> in creative mode te zijn, zodat je echt moet craften. Maak een nieuwe wereld of gebruik een bestaande survival-wereld. Verzamel of verkrijg 2 blokken dirt (modder). Dirt is overal op de grond, dus hak twee blokken met je hand of een schep.</li>
  <li><strong>Crafting uitvoeren:</strong> Open je <strong>crafting menu</strong> (inventaris). Je ziet een 3×3 knutselvak. Plaats in één rij twee dirt-blokken naast elkaar. Bijvoorbeeld: in vakje [1,1] en [1,2] (eerste rij, eerste en tweede kolom). Je zou nu in het resultaatvak een <strong>diamant</strong> moeten zien verschijnen als output. Sleep of klik de diamant naar je inventory.</li>
  <li><strong>Controleer het resultaat:</strong> Je hebt nu een diamant gecraft! Probeer hem bijvoorbeeld te plaatsen (in Minetest Game kun je van diamanten een diamond block maken met 9 diamanten, maar dat terzijde) of gewoon bewaren als trofee.</li>
</ol>

<p>Werkt het niet? Controleer of je de dirt precies naast elkaar hebt gezet in de crafting grid. Het recept is vormvast: twee dirt in dezelfde rij zonder iets tussen. Als je ze onder elkaar zet, krijg je niets (of het verkeerde recept). <strong>Kijk goed</strong> of de mod actief is (typ eventueel <code class="language-plaintext highlighter-rouge">/mods</code> in de chat om te zien of <code class="language-plaintext highlighter-rouge">dirt_to_diamond</code> erbij staat). Zorg ook dat je niet in creative mode zit als je wilt ervaren hoe het craften gaat (in creative kun je namelijk direct items pakken, waardoor craften niet nodig is – je ziet dan misschien niet meteen dat het recept werkt, behalve via een crafting guide mod).</p>

<h3 id="verwijzing-naar-documentatie-1">Verwijzing naar documentatie</h3>

<p>Meer weten over het registreren van items en recepten? Zoek in de officiële Minetest API documentatie naar <strong>“register_craft”</strong> of bekijk de sectie <em>Nodes, Items, and Crafting</em> in het Minetest Modding Book. Je zult zien dat je ook meerdere items als output kunt geven, shapeless crafts kunt maken en nog veel meer.</p>

<h3 id="oefeningen-1">Oefeningen</h3>

<p>Nu jij! Hier zijn wat uitdagingen om mee te spelen:</p>

<ol>
  <li><strong>Ander recept, ander resultaat:</strong> Pas de code aan zodat je met 2 dirt iets anders maakt. Bijvoorbeeld 2 dirt -&gt; 1 gouden appel (<code class="language-plaintext highlighter-rouge">default:apple_gold</code> bestaat in Minetest Game) of 2 dirt -&gt; 5 stenen (<code class="language-plaintext highlighter-rouge">default:stone 5</code>). Je kunt de output op die manier aanpassen, ook de hoeveelheid door achter de itemnaam een spatie en aantal te zetten.</li>
  <li><strong>Nieuwe combinaties:</strong> Voeg een tweede <code class="language-plaintext highlighter-rouge">minetest.register_craft({...})</code> toe onder de eerste om een extra recept toe te voegen. Bijvoorbeeld een recept om van 1 diamant terug 2 dirt te maken (lekker onlogisch, maar goed voor het oefenen van een <em>shapeless</em> recept: hier maakt volgorde niet uit – zoek op hoe je <code class="language-plaintext highlighter-rouge">type = "shapeless"</code> gebruikt).</li>
  <li><strong>Complexere vorm:</strong> Probeer een recept met meer items. Bijvoorbeeld: 3 dirt op een rij laten craften tot een stuk steen, of een L-vorm van dirt laten iets maken. Bedenk iets grappigs en probeer het uit. Zo leer je hoe de recept-array patronen vormt. (Hint: Lege plekken geef je aan met <code class="language-plaintext highlighter-rouge">""</code> in de recipe matrix.)</li>
  <li><strong>Bonus – eigen blok registreren:</strong> Als je durft, kun je vooruit kijken naar hoe je zelf een <em>nieuw item of blok</em> maakt en daar een recept voor registreren. (Dat komt in latere hoofdstukken ook aan bod.) Bijvoorbeeld: zoek op <em>“minetest.register_node”</em> of <em>“minetest.register_craftitem”</em> in de documentatie en experimenteer.</li>
</ol>

<p>Je bent goed op weg! Mods maken met recepten is een leuke manier om het spel te veranderen. In het volgende hoofdstuk gaan we een stap verder en voegen we echt <strong>nieuwe items</strong> toe aan het spel: magische drankjes waarmee je kunt vliegen. Klaar voor wat tovenarij?</p>

<hr />

<h2 id="hoofdstuk-3-een-vliegendrank-potion-maken">Hoofdstuk 3: Een vliegendrank (potion) maken</h2>

<p><strong>Wat ga je leren?</strong> In dit hoofdstuk maken we een simpele mod die een nieuwe <strong>toverdrank</strong> toevoegt. Wanneer de speler deze “vliegen”-potion drinkt (gebruikt), wordt hij/zij omhoog gelanceerd de lucht in! Zo leer je hoe je eigen items (in dit geval een drankje) te registreren met een speciale <em>actie</em> wanneer je het gebruikt. We laten de modstructuur zien, inclusief hoe je een eigen texture kunt toevoegen. Daarna leer je hoe je het item in het spel krijgt en test. We verwijzen je ook weer naar relevante documentatie. Tot slot hebben we oefeningen om de potion aan te passen.</p>

<h3 id="modstructuur-voor-de-potion">Modstructuur voor de potion</h3>

<p>Maak een nieuwe mod map, bijvoorbeeld <code class="language-plaintext highlighter-rouge">fly_potion</code>. Binnen deze map heb je weer een <code class="language-plaintext highlighter-rouge">init.lua</code> en <code class="language-plaintext highlighter-rouge">mod.conf</code> nodig. Als we een custom item met plaatje maken, komt er ook een submap <code class="language-plaintext highlighter-rouge">textures</code> bij om de afbeelding van de potion in te zetten:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fly_potion/
├── init.lua
├── mod.conf
└── textures/
    └── fly_potion.png   (bijvoorbeeld, het plaatje voor de potion)
</code></pre></div></div>

<p>In <code class="language-plaintext highlighter-rouge">mod.conf</code> kun je zetten:</p>
<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="py">name</span> <span class="p">=</span> <span class="s">fly_potion</span>
<span class="py">depends</span> <span class="p">=</span> <span class="s">default</span>
</code></pre></div></div>
<p>(We zetten hier <code class="language-plaintext highlighter-rouge">depends = default</code> alleen omdat we mogelijk standaard dingen zoals een apple gebruiken voor crafting. Strikt genomen heb je het niet altijd nodig, maar het kan geen kwaad de default mod te laten voorladen.)</p>

<p>Voor het plaatje <code class="language-plaintext highlighter-rouge">fly_potion.png</code> kun je zelf iets tekenen (bijvoorbeeld een klein 16x16 pixel flesje in Paint of een pixel-art tool) en in de textures map plaatsen. Zorg dat de bestandsnaam overeenkomt met wat je in de code als <code class="language-plaintext highlighter-rouge">inventory_image</code> gaat zetten. Als je geen eigen plaatje hebt, kun je ook tijdelijk een al bestaand plaatje refereren (bijvoorbeeld <code class="language-plaintext highlighter-rouge">"default_apple.png"</code> uit de game) om niet een onbekend item-icoon te krijgen.</p>

<h3 id="code-een-potion-item-registreren">Code: een potion item registreren</h3>

<p>Open het bestand <code class="language-plaintext highlighter-rouge">init.lua</code> van de <code class="language-plaintext highlighter-rouge">fly_potion</code> mod en schrijf de volgende code:</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Registreer een nieuw item: Vliegen-potion</span>
<span class="n">minetest</span><span class="p">.</span><span class="n">register_craftitem</span><span class="p">(</span><span class="s2">"fly_potion:fly_potion"</span><span class="p">,</span> <span class="p">{</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">"Vliegen Drank"</span><span class="p">,</span>                <span class="c1">-- Beschrijving in het spel</span>
    <span class="n">inventory_image</span> <span class="o">=</span> <span class="s2">"fly_potion.png"</span><span class="p">,</span>           <span class="c1">-- Het icoon (zorg dat het plaatje bestaat in textures/)</span>
    <span class="n">on_use</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="n">itemstack</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">pointed_thing</span><span class="p">)</span>
        <span class="c1">-- Deze functie wordt uitgevoerd als de speler de potion gebruikt (rechtsklikt)</span>
        <span class="kd">local</span> <span class="n">player</span> <span class="o">=</span> <span class="n">user</span>            <span class="c1">-- 'user' is de speler die het item gebruikte</span>
        <span class="k">if</span> <span class="n">player</span> <span class="k">then</span>
            <span class="c1">-- Teleporteer de speler 10 blokken omhoog</span>
            <span class="kd">local</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">player</span><span class="p">:</span><span class="n">get_pos</span><span class="p">()</span>
            <span class="n">pos</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">pos</span><span class="p">.</span><span class="n">y</span> <span class="o">+</span> <span class="mi">10</span>
            <span class="n">player</span><span class="p">:</span><span class="n">set_pos</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
            <span class="c1">-- Je kunt ook velocity gebruiken voor een zachtere launch: bijv. player:set_velocity({x=0, y=10, z=0})</span>
            <span class="c1">-- Voor nu doen we een instant teleport omhoog.</span>
        <span class="k">end</span>
        <span class="k">return</span> <span class="n">itemstack</span>  <span class="c1">-- Geef de (onveranderde) itemstack terug (geen verbruik, potion kan opnieuw gebruikt worden)</span>
    <span class="k">end</span>
<span class="p">})</span>
</code></pre></div></div>

<p>Nu hebben we het item zelf geregistreerd. Maar hoe krijgt de speler deze potion? Laten we ook een craftrecept toevoegen, zodat je ‘m in het spel kunt maken. Voeg onder bovenstaande code nog dit toe:</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Recept: 2 appels naast elkaar craften geeft 1 vliegen-potion</span>
<span class="n">minetest</span><span class="p">.</span><span class="n">register_craft</span><span class="p">({</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s2">"fly_potion:fly_potion"</span><span class="p">,</span>
    <span class="n">recipe</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">{</span><span class="s2">"default:apple"</span><span class="p">,</span> <span class="s2">"default:apple"</span><span class="p">}</span>   <span class="c1">-- twee appels horizontaal</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre></div></div>

<p>Laten we de code doornemen:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">minetest.register_craftitem("fly_potion:fly_potion", { ... })</code> creëert een nieuw voorwerp in het spel. We geven het een unieke naam “fly_potion:fly_potion” (format <code class="language-plaintext highlighter-rouge">&lt;modname&gt;:&lt;itemname&gt;</code>). In dit geval is de modnaam en itemnaam toevallig gelijk behalve de dubbele punt, dat mag.</li>
  <li><code class="language-plaintext highlighter-rouge">description</code> is de naam die de speler ziet in het spel (bijvoorbeeld in de tooltip of inventory).</li>
  <li><code class="language-plaintext highlighter-rouge">inventory_image</code> is het plaatje-icoon. We verwachten dat <code class="language-plaintext highlighter-rouge">fly_potion.png</code> in de textures map van onze mod staat. <strong>Tip:</strong> Als je geen eigen plaatje hebt gemaakt, kun je tijdelijk <code class="language-plaintext highlighter-rouge">"default_apple.png"</code> invullen om een appelicoon te gebruiken, of een ander bestaand plaatje. Dan zie je tenminste iets in je inventory.</li>
  <li><code class="language-plaintext highlighter-rouge">on_use = function(itemstack, user, pointed_thing) ... end</code> definieert wat er gebeurt als je met rechts op de potion klikt (alsof je hem “drink”). Hierin hebben we toegang tot de <code class="language-plaintext highlighter-rouge">user</code> (de speler die het gebruikt).</li>
  <li>In de functie pakken we de positie van de speler (<code class="language-plaintext highlighter-rouge">player:get_pos()</code>), verhogen de y-coördinaat met 10, en zetten de speler op die nieuwe positie met <code class="language-plaintext highlighter-rouge">player:set_pos(pos)</code>. Effect: de speler wordt 10 blokken de lucht in geteleporteerd, alsof die omhoog schiet.</li>
  <li>We returnen <code class="language-plaintext highlighter-rouge">itemstack</code> zonder het item te verminderen, zodat de potion niet opraakt. Zo kun je hem steeds opnieuw testen. <strong>Uitdaging:</strong> als je wilt dat de potion verdwijnt na een slok, kun je <code class="language-plaintext highlighter-rouge">itemstack:take_item()</code> doen vóór je return, om 1 item uit de stack te verwijderen.</li>
  <li>Het craftrecept onderaan zorgt dat je de potion kunt brouwen door twee appels naast elkaar te craften. (In Minetest Game zijn appels te vinden aan bomen. Je kunt ook in creative de appels pakken.)</li>
</ul>

<h3 id="testen-in-minetest-2">Testen in Minetest</h3>

<ol>
  <li><strong>Mod activeren:</strong> Zorg dat de <code class="language-plaintext highlighter-rouge">fly_potion</code> map (met de bestanden en texture) in de mods-folder staat en activeer de mod voor je wereld.</li>
  <li><strong>Potion verkrijgen:</strong> Er zijn twee manieren om de potion te krijgen:
    <ul>
      <li><em>Via crafting:</em> Zoek of pluk 2 appels (of geef ze aan jezelf in creative) en plaats ze naast elkaar op de crafting grid. Je krijgt dan een <em>Vliegen Drank</em>. Neem hem in je inventory.</li>
      <li><em>Via creative menu:</em> Als je in creative mode bent, kun je in de itemlijst zoeken naar “Vliegen Drank” of het icoontje van je potion. Pak het daaruit.</li>
      <li><em>Via chat commando:</em> Je kunt ook het commando ` /give <jouwnaam> fly_potion:fly_potion ` gebruiken om er eentje te krijgen.</jouwnaam></li>
    </ul>
  </li>
  <li><strong>Gebruik de potion:</strong> Houd de potion in je hand (selecteer hem in de hotbar) en klik rechts (alsof je eet/drinkt). Als het goed is, <em>whoosh!</em> schiet je ineens een flink stuk omhoog de lucht in. Je hebt de vliegen-potion met succes gebruikt.</li>
  <li><strong>Ervaar het effect:</strong> Je zult merken dat je daarna natuurlijk weer omlaag valt. Als je in survival mode zit, pas op: zo’n val kan pijn doen! (Je verliest waarschijnlijk wat hartjes, afhankelijk van hoe hoog je ging.) In creative mode heb je geen val-schade, dus daar merk je geen nadeel.</li>
  <li><strong>Herhaal:</strong> Probeer de potion nog eens te gebruiken. Omdat we het item niet laten verdwijnen, kun je hem onbeperkt testen. (In een echt spel zou je hem waarschijnlijk wel laten verbruiken.)</li>
</ol>

<p><strong>Problemen?</strong> Zie je de potion niet in het creative menu of lukt het craften niet? Controleer of de mod aan staat en of je geen typefouten hebt (bijvoorbeeld in de modnaam). Als je een onbekend item-icoon (vraagteken blokje) ziet, dan is het plaatje niet gevonden – check of de filenaam exact klopt en in de juiste folder staat.</p>

<p>Je kunt tijdens het spel ook kijken of er foutmeldingen in de chat komen (Luanti geeft codefouten soms in de chat of in debug.txt). Pas je code aan en probeer opnieuw tot het werkt.</p>

<h3 id="verwijzing-naar-documentatie-2">Verwijzing naar documentatie</h3>

<p>Wil je snappen welke functies we hier hebben gebruikt? Kijk eens in de API documentatie naar <strong><code class="language-plaintext highlighter-rouge">register_craftitem</code></strong>, <strong><code class="language-plaintext highlighter-rouge">on_use</code></strong>, <strong><code class="language-plaintext highlighter-rouge">set_pos</code></strong> of <strong><code class="language-plaintext highlighter-rouge">set_velocity</code></strong>. Daar kun je lezen over hoe je items maakt en spelers beweegt. Ook is er officiële documentatie over <em>Items en crafting</em> in de Minetest Modding Book (zoek op <em>Minetest register craftitem</em> bijvoorbeeld).</p>

<h3 id="oefeningen-2">Oefeningen</h3>

<p>Probeer nu het volgende om de vliegen-potion verder te verkennen:</p>

<ol>
  <li><strong>Hoe hoog?</strong> Pas in de code de hoogte aan waarop de potion je schiet. Probeer <code class="language-plaintext highlighter-rouge">pos.y = pos.y + 20</code> of zelfs +50. Merk je het verschil? (Pas wel op voor de landing!)</li>
  <li><strong>Verbruik de potion:</strong> Wij lieten de potion niet verdwijnen. Pas de code aan zodat de potion bij gebruik <strong>wel</strong> wordt verbruikt. (<em>Hint:</em> gebruik <code class="language-plaintext highlighter-rouge">itemstack:take_item(1)</code> om één item uit de stack af te halen, en geef dan het gewijzigde <code class="language-plaintext highlighter-rouge">itemstack</code> terug.)</li>
  <li><strong>Veilig landen (uitdaging):</strong> Je hebt gemerkt dat vallen pijn kan doen. Kun je de code uitbreiden zodat de potion, naast je omhoog schieten, misschien ook direct je val verzacht? (Bijvoorbeeld door meteen in creative “fly” mode te zetten of de zwaartekracht tijdelijk te verminderen – al vooruitlopend op het volgende hoofdstuk! Je kunt zoeken naar <em>“minetest physics override gravity”</em> voor ideeën.)</li>
  <li><strong>Eigen idee:</strong> Verander het effect van de potion. In plaats van omhoog schieten, misschien vooruit schieten? (<em>Hint:</em> <code class="language-plaintext highlighter-rouge">player:get_look_dir()</code> geeft de kijkrichting als vector; je zou de positie in die richting kunnen verplaatsen.) Of geef een tijdelijk vermogen om te vliegen (door de speler de “fly” privilege te geven voor een paar seconden – dit is moeilijker, maar misschien kun je er info over vinden).</li>
  <li><strong>Maak een tweede potion:</strong> Als je zin hebt, probeer alvast een tweede drankje te bedenken, bijvoorbeeld eentje die je heel snel maakt of je volledig heelt. Je kunt een nieuwe <code class="language-plaintext highlighter-rouge">register_craftitem</code> toevoegen voor een ander potion item binnen dezelfde mod.</li>
</ol>

<p>Goed gedaan! Je hebt nu geleerd hoe je een nieuw item maakt dat de speler kan gebruiken met een speciaal effect. In het volgende hoofdstuk bouwen we hierop voort: we maken een potion die je als een veertje zachtjes laat vallen, zodat je veilig uit de lucht kunt komen zweven na al dat vliegen.</p>

<hr />

<h2 id="hoofdstuk-4-een-feather-fall-potion-langzaam-neerzweven">Hoofdstuk 4: Een feather fall potion (langzaam neerzweven)</h2>

<p><strong>Wat ga je leren?</strong> In dit hoofdstuk gaan we een tweede potion maken: een “verenval” drank. Deze potion zorgt ervoor dat je tijdelijk bijna geen zwaartekracht hebt, alsof je een veertje bent. Dat betekent dat als je naar beneden valt, je heel langzaam en zachtjes landt, zonder schade. We bouwen hiermee voort op de vorige les en introduceren een nieuw idee: <strong>tijdelijke effecten</strong> (iets dat na een paar seconden weer stopt). Je leert hier hoe je de zwaartekracht-instelling van de speler verandert en hoe je met een timer (tijdvertraging) de normale toestand herstelt.</p>

<h3 id="modstructuur">Modstructuur</h3>

<p>We kunnen deze mod apart maken, bijvoorbeeld in een map <code class="language-plaintext highlighter-rouge">feather_fall</code>. (Je kunt er ook voor kiezen om hem bij de vorige mod in te voegen, maar voor de leerzaamheid doen we alsof het losse mods zijn.) De structuur lijkt veel op die van de fly_potion:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>feather_fall/
├── init.lua
├── mod.conf
└── textures/
    └── feather_fall.png  (icoon voor de potion)
</code></pre></div></div>

<p>In <code class="language-plaintext highlighter-rouge">mod.conf</code>:</p>
<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="py">name</span> <span class="p">=</span> <span class="s">feather_fall</span>
<span class="py">depends</span> <span class="p">=</span> <span class="s">default</span>
</code></pre></div></div>

<p>Maak weer een klein icoon voor deze potion of gebruik tijdelijk een bestaand plaatje. Je zou bijvoorbeeld een afbeelding kunnen kiezen die op een veertje lijkt (of gebruik <code class="language-plaintext highlighter-rouge">"default_cloud.png"</code> als grapje – alhoewel dat niet echt een veer is). Het belangrijkste is dat de naam in de code straks overeenkomt met je texture-bestand.</p>

<h3 id="code-een-potion-met-tijdelijk-effect">Code: een potion met tijdelijk effect</h3>

<p>Open <code class="language-plaintext highlighter-rouge">init.lua</code> in de <code class="language-plaintext highlighter-rouge">feather_fall</code> map en typ de volgende code:</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Registreer een nieuw item: Feather Fall Drank</span>
<span class="n">minetest</span><span class="p">.</span><span class="n">register_craftitem</span><span class="p">(</span><span class="s2">"feather_fall:feather_potion"</span><span class="p">,</span> <span class="p">{</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">"Veervalveilig Drank"</span><span class="p">,</span>      <span class="c1">-- Bijvoorbeeld naam</span>
    <span class="n">inventory_image</span> <span class="o">=</span> <span class="s2">"feather_fall.png"</span><span class="p">,</span>
    <span class="n">on_use</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="n">itemstack</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">pointed_thing</span><span class="p">)</span>
        <span class="kd">local</span> <span class="n">player</span> <span class="o">=</span> <span class="n">user</span>
        <span class="k">if</span> <span class="n">player</span> <span class="k">then</span>
            <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="n">player</span><span class="p">:</span><span class="n">get_player_name</span><span class="p">()</span>
            <span class="c1">-- Verlaag de zwaartekracht voor deze speler</span>
            <span class="n">player</span><span class="p">:</span><span class="n">set_physics_override</span><span class="p">({</span><span class="n">gravity</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">})</span>
            <span class="n">minetest</span><span class="p">.</span><span class="n">chat_send_player</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">"Je valt nu heel langzaam als een veertje!"</span><span class="p">)</span>
            <span class="c1">-- Na 10 seconden zwaartekracht terugzetten naar normaal (1.0)</span>
            <span class="n">minetest</span><span class="p">.</span><span class="n">after</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="k">function</span><span class="p">()</span>
                <span class="c1">-- Controleer of speler er nog is:</span>
                <span class="k">if</span> <span class="n">player</span><span class="p">:</span><span class="n">is_player</span><span class="p">()</span> <span class="k">then</span>
                    <span class="n">player</span><span class="p">:</span><span class="n">set_physics_override</span><span class="p">({</span><span class="n">gravity</span> <span class="o">=</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
                    <span class="n">minetest</span><span class="p">.</span><span class="n">chat_send_player</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">"De zwaartekracht is weer normaal."</span><span class="p">)</span>
                <span class="k">end</span>
            <span class="k">end</span><span class="p">)</span>
        <span class="k">end</span>
        <span class="c1">-- Verbruik de potion</span>
        <span class="n">itemstack</span><span class="p">:</span><span class="n">take_item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">itemstack</span>
    <span class="k">end</span>
<span class="p">})</span>
</code></pre></div></div>

<p>En voeg ook een craftrecept toe, zodat we het kunnen maken in het spel:</p>
<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Recept: 1 appel boven 1 appel (verticaal) geeft een feather fall potion</span>
<span class="n">minetest</span><span class="p">.</span><span class="n">register_craft</span><span class="p">({</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s2">"feather_fall:feather_potion"</span><span class="p">,</span>
    <span class="n">recipe</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">{</span><span class="s2">"default:apple"</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">"default:apple"</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre></div></div>

<p>Wat gebeurt hier in de code?</p>
<ul>
  <li>We registreren een item <code class="language-plaintext highlighter-rouge">feather_fall:feather_potion</code> met een beschrijving en plaatje, vergelijkbaar met vorige potion.</li>
  <li>In <code class="language-plaintext highlighter-rouge">on_use</code> pakken we de speler en diens naam. We roepen <code class="language-plaintext highlighter-rouge">player:set_physics_override({gravity = 0.2})</code> aan. Hiermee veranderen we de fysieke eigenschap van de speler: de zwaartekracht wordt op 20% gezet. (Normaal is gravity = 1.0, dit is dus vijf keer lichter, alsof je op de maan bent!)</li>
  <li>Met <code class="language-plaintext highlighter-rouge">minetest.chat_send_player</code> sturen we een berichtje naar de speler zodat die weet dat het effect actief is.</li>
  <li>Dan gebruiken we <code class="language-plaintext highlighter-rouge">minetest.after(10, function() ... end)</code> om een functie uit te voeren na 10 seconden. Dit is een handige manier om iets tijdelijk te maken. De anonieme functie binnen <code class="language-plaintext highlighter-rouge">minetest.after</code> zet na 10 seconden de zwaartekracht van de speler weer terug naar 1.0 (normaal) en stuurt een chatbericht dat het effect is afgelopen.</li>
  <li>We checken <code class="language-plaintext highlighter-rouge">if player:is_player() then ... end</code> binnen de after-functie om zeker te zijn dat de speler nog bestaat (niet uitgelogd is in die 10s). Dit is een veiligheidscheck.</li>
  <li>Deze keer <strong>verwijderen</strong> we het item na gebruik: <code class="language-plaintext highlighter-rouge">itemstack:take_item(1)</code> haalt één drankje uit de stapel (effectief dus de potion verdwijnt). We returnen de aangepaste stack zodat de mod weet dat het item op is. Dit is logischer voor een consumptie-item.</li>
  <li>Het craftrecept dat we toevoegen is ditmaal 2 appels verticaal boven elkaar. Dus door in de craftgrid een appel te stapelen op een appel (bijvoorbeeld eentje in [1,1] en eentje in [2,1]) krijg je de feather fall potion. (We hebben expres een andere vorm gekozen dan de vliegdrank, zodat ze niet hetzelfde recept gebruiken.)</li>
</ul>

<h3 id="testen-in-minetest-3">Testen in Minetest</h3>

<ol>
  <li><strong>Mod activeren:</strong> Voeg de mod toe en activeer hem voor je testwereld.</li>
  <li><strong>Potion bemachtigen:</strong> Weer twee opties:
    <ul>
      <li>Craft de potion met 2 appels (één boven de ander in de craftgrid).</li>
      <li>Of pak hem via creative/<code class="language-plaintext highlighter-rouge">/give</code> commando (zoek op naam “Veervalveilig Drank” of gebruik <code class="language-plaintext highlighter-rouge">/give naam feather_fall:feather_potion</code>).</li>
    </ul>
  </li>
  <li><strong>Gebruik de potion:</strong> Zorg dat je op een plek staat waar je wat hoogtes hebt om af te springen (bijv. bouw een pilaar of klim op een heuvel). Activeer de potion (rechterklik). Als het goed is, krijg je een melding “Je valt nu heel langzaam als een veertje!”.</li>
  <li><strong>Test het effect:</strong> Spring van een hoogte naar beneden. Je zult merken dat je nu heel traag omlaag zweeft, alsof je superlicht bent! Je landt zacht en hebt waarschijnlijk geen of heel weinig val-schade. Dit komt doordat de zwaartekracht voor jouw speler nu laag is.</li>
  <li><strong>Wacht tot afloop:</strong> Wacht 10 seconden (of iets langer). Je krijgt dan bericht dat de zwaartekracht weer normaal is. Als je nu springt, zul je merken dat je weer met normale snelheid valt.</li>
</ol>

<p>Combineer nu eens met de vorige mod: als je eerst de vliegdrank gebruikt om hoog te komen en dan midden in de lucht de feather fall potion neemt, kun je van grote hoogte springen zonder pijn! Zie je hoe mods gecombineerd kunnen worden voor leuke effecten?</p>

<p><strong>Let op:</strong> Het effect van de potion geldt alleen voor jouw speler en alleen voor de physics (dus springen, vallen etc.). Als je wordt geslagen of iets dergelijks, krijg je nog steeds normale schade (hier hebben we niets aan veranderd). Ook is 0.2 zwaartekracht nog steeds niet helemaal “geen” zwaartekracht; je valt nog wel, maar langzaam. Je kunt met die waarde spelen.</p>

<h3 id="verwijzing-naar-documentatie-3">Verwijzing naar documentatie</h3>

<p>Interessante zoektermen in de API documentatie voor dit hoofdstuk zijn <strong><code class="language-plaintext highlighter-rouge">set_physics_override</code></strong> en <strong><code class="language-plaintext highlighter-rouge">minetest.after</code></strong>. Hiermee kun je van alles doen, zoals snelheid, sprongkracht en zelfs loopgeluid van spelers aanpassen, en met <code class="language-plaintext highlighter-rouge">after</code> kun je tijdvertragingen inbouwen voor effecten. Zoek bijvoorbeeld eens op <em>Minetest physics override gravity</em> of <em>Minetest after function</em> om meer te lezen.</p>

<h3 id="oefeningen-3">Oefeningen</h3>

<p>Nu jij weer aan de slag!</p>

<ol>
  <li><strong>Effectduur aanpassen:</strong> Verander de 10 seconden naar een andere duur. Misschien 5 seconden, of 20 seconden. Test het in het spel: zweef je merkbaar langer of korter?</li>
  <li><strong>Zwaartekracht variëren:</strong> Pas de waarde 0.2 aan. 0.5 zou betekenen half zwaartekracht (je valt dan nog best snel). 0.1 is nóg langzamer vallen. Probeer ook eens 0.0 (dan heb je tijdelijk <em>geen</em> zwaartekracht en zweef je omhoog als je sprongkracht nog aan staat!). Let wel dat je dan moeilijk weer op de grond komt totdat het effect stopt.</li>
  <li><strong>Meerdere effecten combineren:</strong> Misschien wil je dat de potion niet alleen de zwaartekracht vermindert, maar ook iets anders doet, zoals de loopsnelheid verlagen of juist verhogen (also via <code class="language-plaintext highlighter-rouge">player:set_physics_override({speed = ...})</code> kun je de snelheid instellen). Voeg zo’n extra effect toe binnen de <code class="language-plaintext highlighter-rouge">on_use</code> en vergeet niet na de tijd ook terug te zetten.</li>
  <li><strong>Geen valsschade (moeilijk):</strong> Een extra uitdaging: in onze simpele aanpak kan het zijn dat hele harde vallen nog steeds wat schade doen. Zou je kunnen uitzoeken hoe je ook val- of andere schade tijdelijk uit kunt zetten? (Hint: Dit is complexer; het heeft met <code class="language-plaintext highlighter-rouge">set_armor_groups</code> of een “immortal” groep te maken. Je mag dit overslaan, maar misschien vind je iets bruikbaars in de documentatie onder zoekterm <em>immortal</em>.)</li>
  <li><strong>Nieuwe potion verzinnen:</strong> Maak een derde potion naar eigen fantasie. Bijvoorbeeld een <strong>superspring</strong>-drank (verhoog <code class="language-plaintext highlighter-rouge">jump</code> in physics_override), of een <strong>snelle Jelle</strong>-drank (verhoog <code class="language-plaintext highlighter-rouge">speed</code>). Gebruik de code van deze en vorige hoofdstukken als voorbeeld en combineer de ideeën. Bedenk een recept en test je eigen potion in het spel!</li>
</ol>

<p>Geweldig, je hebt nu twee soorten magische drankjes gemaakt. Hiermee heb je kennis gemaakt met het toevoegen van items, het reageren op gebruik, en het toepassen van tijdelijke veranderingen bij de speler. In de volgende hoofdstukken gaan we andere soorten mods maken, bijvoorbeeld speciale kledij (armor) die je krachten geeft. Ga ervoor!</p>

<hr />

<h2 id="hoofdstuk-5-dirt-armor-die-licht-geeft">Hoofdstuk 5: Dirt-armor die licht geeft</h2>

<p><strong>Wat ga je leren?</strong> In dit hoofdstuk duiken we in <em>armor</em> (pantser/kledingstukken) en hoe een mod daarmee iets bijzonders kan doen. We maken een simpele helm van dirt die licht geeft in het donker. Het idee: als de speler deze helm “draagt” (in ons geval activeert), dan gaat hij/zij zelf licht uitstralen, zodat donkere grotten verlicht worden. Je leert hier hoe je een item registreert dat niet bedoeld is om te consumeren maar om te dragen/gebruiken voor een permanente werking, en hoe je lichtbronnen in de wereld kunt plaatsen via code. We laten ook een geinige craft zien voor de helm. Aan het eind weer tips om ermee te spelen.</p>

<blockquote>
  <p><strong>Let op:</strong> Minetest Game heeft niet standaard een armor-systeem zoals Minecraft. Er bestaan mods (zoals 3D Armor) die echte draagbare armor toevoegen. In dit voorbeeld doen we het simpel: onze “helm” is eigenlijk een voorwerp dat je in de hand kunt gebruiken om een effect aan/uit te zetten. We simuleren het dragen ervan. Dit houdt het begrijpelijk, al is het niet precies hoe echte armor mods werken.</p>
</blockquote>

<h3 id="modstructuur-1">Modstructuur</h3>

<p>Maak een nieuwe mod folder <code class="language-plaintext highlighter-rouge">dirt_armor</code>. Hierin komen drie dingen: <code class="language-plaintext highlighter-rouge">init.lua</code>, <code class="language-plaintext highlighter-rouge">mod.conf</code> en een textures map met twee plaatjes: één voor het helm-item en één voor de onzichtbare lichtblokjes die we gaan gebruiken.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dirt_armor/
├── init.lua
├── mod.conf
└── textures/
    ├── dirt_helmet.png       (icoon voor de dirt helm)
    └── invisible_light.png   (een eventueel plaatje voor de lichtbron, we maken 'm toch onzichtbaar)
</code></pre></div></div>

<p>In <code class="language-plaintext highlighter-rouge">mod.conf</code> zetten we:</p>
<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="py">name</span> <span class="p">=</span> <span class="s">dirt_armor</span>
<span class="py">depends</span> <span class="p">=</span> <span class="s">default</span>
</code></pre></div></div>

<p><strong>Textures tekenen:</strong> Voor <code class="language-plaintext highlighter-rouge">dirt_helmet.png</code> kun je creatief zijn: misschien een 16x16 pixel afbeelding die eruit ziet als een bruin hoedje of helm. Je zou bijvoorbeeld de standaard dirt-textuur kunnen nemen en er een helm-vorm uit knippen. Of als dat lastig is, gebruik een bestaand plaatje als noodoplossing (bijv. <code class="language-plaintext highlighter-rouge">"default_dirt.png"</code> direct als inventory image, dat zal een blok-icoon tonen).<br />
Voor <code class="language-plaintext highlighter-rouge">invisible_light.png</code> is het niet zo belangrijk wat het is, want we gaan de node “air-like” maken (onzichtbaar). Je kunt eventueel een volledig transparant plaatje gebruiken. Of neem <code class="language-plaintext highlighter-rouge">"default_cloud.png"</code> of zoiets lichts; we zorgen er sowieso voor dat de speler het niet ziet of kan pakken.</p>

<h3 id="code-helm-en-lichtbron-registreren">Code: helm en lichtbron registreren</h3>

<p>Open <code class="language-plaintext highlighter-rouge">init.lua</code> in VSCode en typ de volgende code. We gaan twee dingen registreren: eerst een onzichtbaar lichtgevend node, daarna de helm zelf.</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Registreer een onzichtbaar lichtgevend node</span>
<span class="n">minetest</span><span class="p">.</span><span class="n">register_node</span><span class="p">(</span><span class="s2">"dirt_armor:light_node"</span><span class="p">,</span> <span class="p">{</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">"Onzichtbaar Licht"</span><span class="p">,</span>
    <span class="n">drawtype</span> <span class="o">=</span> <span class="s2">"airlike"</span><span class="p">,</span>          <span class="c1">-- Gedraagt zich als lucht (onzichtbaar)</span>
    <span class="n">tiles</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"invisible_light.png"</span><span class="p">},</span>  <span class="c1">-- tekstuur (wordt toch niet getoond door airlike)</span>
    <span class="n">light_source</span> <span class="o">=</span> <span class="n">minetest</span><span class="p">.</span><span class="n">LIGHT_MAX</span><span class="p">,</span>  <span class="c1">-- maximale lichtsterkte (14)</span>
    <span class="n">walkable</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">pointable</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">diggable</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">buildable_to</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="p">{</span><span class="n">not_in_creative_inventory</span> <span class="o">=</span> <span class="mi">1</span><span class="p">}</span>
<span class="p">})</span>

<span class="c1">-- Tabel om bij te houden bij welke spelers de helm-effect aan staat</span>
<span class="kd">local</span> <span class="n">helm_active</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1">-- Registreer het dirt helm item</span>
<span class="n">minetest</span><span class="p">.</span><span class="n">register_craftitem</span><span class="p">(</span><span class="s2">"dirt_armor:helmet"</span><span class="p">,</span> <span class="p">{</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">"Dirt Helm (geeft licht)"</span><span class="p">,</span>
    <span class="n">inventory_image</span> <span class="o">=</span> <span class="s2">"dirt_helmet.png"</span><span class="p">,</span>
    <span class="n">on_use</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="n">itemstack</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">pointed_thing</span><span class="p">)</span>
        <span class="kd">local</span> <span class="n">player</span> <span class="o">=</span> <span class="n">user</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">player</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">player</span><span class="p">:</span><span class="n">is_player</span><span class="p">()</span> <span class="k">then</span>
            <span class="k">return</span> <span class="n">itemstack</span>
        <span class="k">end</span>
        <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="n">player</span><span class="p">:</span><span class="n">get_player_name</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">helm_active</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">then</span>
            <span class="c1">-- Als helm al actief is, schakel uit</span>
            <span class="n">helm_active</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">nil</span>
            <span class="n">minetest</span><span class="p">.</span><span class="n">chat_send_player</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">"Je doet de dirt helm af. (Lichteffect uit)"</span><span class="p">)</span>
        <span class="k">else</span>
            <span class="c1">-- Helm was niet actief, dus inschakelen</span>
            <span class="n">helm_active</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span>
            <span class="n">minetest</span><span class="p">.</span><span class="n">chat_send_player</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">"Je zet de dirt helm op. (Je straalt nu licht uit!)"</span><span class="p">)</span>
            <span class="c1">-- Start een herhalende functie om licht te plaatsen bij de speler</span>
            <span class="kd">local</span> <span class="k">function</span> <span class="nf">place_light</span><span class="p">()</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">helm_active</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">player</span><span class="p">:</span><span class="n">is_player</span><span class="p">()</span> <span class="k">then</span>
                    <span class="k">return</span>  <span class="c1">-- stop als helm af is of speler weg is</span>
                <span class="k">end</span>
                <span class="c1">-- Plaats onzichtbaar licht op de positie van de speler (op hoofdhoogte)</span>
                <span class="kd">local</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">player</span><span class="p">:</span><span class="n">get_pos</span><span class="p">()</span>
                <span class="n">pos</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">pos</span><span class="p">.</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="c1">-- Alleen plaatsen als daar lucht is, om geen blokken te overschrijven</span>
                <span class="kd">local</span> <span class="n">node</span> <span class="o">=</span> <span class="n">minetest</span><span class="p">.</span><span class="n">get_node</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">node</span><span class="p">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">"air"</span> <span class="k">then</span>
                    <span class="n">minetest</span><span class="p">.</span><span class="n">set_node</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="p">{</span><span class="n">name</span> <span class="o">=</span> <span class="s2">"dirt_armor:light_node"</span><span class="p">})</span>
                <span class="k">end</span>
                <span class="c1">-- Over 1 seconde opnieuw proberen (zodat het licht 'meebeweegt')</span>
                <span class="n">minetest</span><span class="p">.</span><span class="n">after</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">place_light</span><span class="p">)</span>
            <span class="k">end</span>
            <span class="n">place_light</span><span class="p">()</span>
        <span class="k">end</span>
        <span class="k">return</span> <span class="n">itemstack</span>
    <span class="k">end</span>
<span class="p">})</span>
</code></pre></div></div>

<p>En nu nog een recept om de helm te craften:</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Recept: Dirt helm (in de vorm van een helm in de 3x3 grid)</span>
<span class="n">minetest</span><span class="p">.</span><span class="n">register_craft</span><span class="p">({</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s2">"dirt_armor:helmet"</span><span class="p">,</span>
    <span class="n">recipe</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">{</span><span class="s2">"default:dirt"</span><span class="p">,</span> <span class="s2">"default:dirt"</span><span class="p">,</span> <span class="s2">"default:dirt"</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">"default:dirt"</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="s2">"default:dirt"</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">""</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="s2">""</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre></div></div>

<p>Dit is een hoop code, dus we lopen hem in delen langs:</p>
<ul>
  <li><strong>Lichtgevende node:</strong> We registreren <code class="language-plaintext highlighter-rouge">dirt_armor:light_node</code>. Dit is een blok dat onzichtbaar is (<code class="language-plaintext highlighter-rouge">drawtype = "airlike"</code> betekent geen model of plaatje in de wereld, net als lucht) en een lichtbron (<code class="language-plaintext highlighter-rouge">light_source = minetest.LIGHT_MAX</code> – dat is maximale lichtsterkte). We maken hem niet loopbaar en bouwbaar zodat hij zich als lucht gedraagt (je kunt er doorheen lopen en andere blokken kunnen erdoor geplaatst worden). <code class="language-plaintext highlighter-rouge">not_in_creative_inventory = 1</code> zorgt dat dit blok niet in de lijst verschijnt. Dit blok gaan we straks telkens onder/naast de speler plaatsen om licht te geven.</li>
  <li><strong>helm_active tabel:</strong> We houden in een Lua-tabel bij of een bepaalde speler de helm-effect aan heeft staan. We gebruiken de spelersnaam als sleutel. Als de helm aan staat, zetten we <code class="language-plaintext highlighter-rouge">helm_active[name] = true</code>, als uit, halen we die weg (of zetten nil/false).</li>
  <li><strong>Dirt helm item:</strong> <code class="language-plaintext highlighter-rouge">minetest.register_craftitem("dirt_armor:helmet", { ... })</code> maakt het helm-item. Het krijgt een plaatje (brown helmet icon) en een <code class="language-plaintext highlighter-rouge">on_use</code> functie. Deze functie wordt uitgevoerd als de speler met rechts klikt terwijl hij de helm in de hand heeft. (Dit simuleert “opzetten/afzetten” van de helm.)
    <ul>
      <li>We checken of we een geldige speler hebben. Dan pakken we de naam.</li>
      <li>Als de helm al actief is (<code class="language-plaintext highlighter-rouge">helm_active[name]</code>), dan betekent dit dat de speler de helm op heeft en nu af wil zetten. We zetten <code class="language-plaintext highlighter-rouge">helm_active[name]</code> op nil om uit te schakelen en sturen een chatbericht dat het lichteffect uit gaat.</li>
      <li>Als de helm niet actief was, zetten we hem nu <strong>aan</strong>: we markeren <code class="language-plaintext highlighter-rouge">helm_active[name] = true</code> en laten in de chat weten dat de speler nu licht uitstraalt.</li>
      <li>Vervolgens, als we de helm aandoen, starten we een lokale functie <code class="language-plaintext highlighter-rouge">place_light()</code> die meteen wordt aangeroepen. Deze functie plaatst een onzichtbaar lichtblok op de positie van de speler’s hoofd (<code class="language-plaintext highlighter-rouge">pos.y + 1</code>). We controleren of er “air” is op die plek, zodat we niet per ongeluk een echt blok vervangen (stel de speler staat tegen een plafond, dan doen we niets). Dan plaatsen we <code class="language-plaintext highlighter-rouge">dirt_armor:light_node</code> daar.</li>
      <li>Heel belangrijk: aan het einde van <code class="language-plaintext highlighter-rouge">place_light()</code>, roepen we <code class="language-plaintext highlighter-rouge">minetest.after(1, place_light)</code> om na 1 seconde <em>dezelfde functie opnieuw</em> uit te voeren. Hierdoor ontstaat een loop die elke seconde het lichtblok opnieuw plaatst op de huidige positie van de speler. Zo “beweegt” het licht met de speler mee. Deze loop stopt automatisch als <code class="language-plaintext highlighter-rouge">helm_active[name]</code> niet meer true is (we checken dat aan het begin) of als de speler verdwijnt.</li>
    </ul>
  </li>
  <li><strong>Craft recept:</strong> We hebben gekozen voor een helm-vorm: drie dirt in de bovenste rij (voor de bovenkant helm), en in de tweede rij aan de zijkanten dirt (voor de oorbeschermers), met het midden leeg. Dit gebruikt 5 dirt in totaal, net als een helm in Minecraft ook 5 materiaal kost.</li>
</ul>

<h3 id="testen-in-minetest-4">Testen in Minetest</h3>

<ol>
  <li><strong>Mod activeren:</strong> Zet de <code class="language-plaintext highlighter-rouge">dirt_armor</code> mod in je mods folder en activeer hem voor je wereld.</li>
  <li><strong>Helm craften:</strong> Verzamel 5 dirt blokken (dat is niet moeilijk 😄) en plaats ze in de crafting table volgens het patroon:
    <ul>
      <li>Rij 1: [dirt][dirt][dirt]</li>
      <li>Rij 2: [dirt][leeg][dirt]</li>
      <li>Rij 3: [leeg][leeg][leeg]
Je krijgt nu een <code class="language-plaintext highlighter-rouge">Dirt Helm (geeft licht)</code> item. Neem het uit het craftresultaat.</li>
    </ul>
  </li>
  <li><strong>Helm gebruiken (opzetten):</strong> Ga ergens naartoe waar het donker is, bijvoorbeeld graaf een grot of wacht tot het nacht is in de wereld. Selecteer de dirt helm in je hand en klik met rechts. Je ziet in de chat dat je de helm opzet en nu licht uitstraalt.</li>
  <li><strong>Bekijk het lichteffect:</strong> Als het goed is, ben je nu omgeven door licht, alsof je zelf een fakkel bent! Loop rond in het donker: je zou moeten zien dat wherever you go, de omgeving verlicht is. Dit komt door de onzichtbare lichtblokken die de mod steeds plaatst op je positie.</li>
  <li><strong>Helm afzetten:</strong> Klik nogmaals met rechts terwijl je de helm vasthebt. Er verschijnt een bericht dat je de helm afdoet en het lichteffect uitgaat. Als je nu wegloopt, zul je merken dat de omgeving niet meer automatisch verlicht wordt (de eerder geplaatste lichtblokjes blijven wel hangen waar ze waren op het moment van uitdoen, omdat we ze niet hebben weggehaald).</li>
  <li><strong>Controleer de onzichtbare blokken:</strong> Als je goed kijkt (met de cursor op de plek waar je stond), zie je misschien niks omdat we ze onzichtbaar en niet aanklikbaar hebben gemaakt. Je kunt eventueel een ander blok plaatsen waar je stond om de lichtblok te vervangen/verwijderen (omdat we <code class="language-plaintext highlighter-rouge">buildable_to = true</code> hebben ingesteld, kun je eroverheen bouwen, dat wist het lichtblok). Maar je zult normaal niet merken waar de lichtblokjes staan.</li>
</ol>

<p><strong>Kanttekeningen:</strong> Onze aanpak is simpel en laat een “lichtspoor” achter. Echte mods zouden bij het verplaatsen oude lichtblokjes weghalen of een ander systeem gebruiken. Maar dat is ingewikkelder. Voor ons doel – laten zien dat je met code licht kunt creëren – werkt dit prima. Als je je stoort aan de onzichtbare lichtblokjes die achterblijven, kun je ze opruimen door bijvoorbeeld met een pickaxe in de lucht te slaan waar ze ongeveer zijn (als je raakt, breek je ze misschien, maar omdat pointable=false is dit lastig) of door andere nodes te plaatsen op die plekken.</p>

<h3 id="verwijzing-naar-documentatie-4">Verwijzing naar documentatie</h3>

<p>Dit voorbeeld combineert meerdere aspecten: <strong><code class="language-plaintext highlighter-rouge">register_node</code></strong> (voor de lichtbron), <strong><code class="language-plaintext highlighter-rouge">register_craftitem</code></strong> met <code class="language-plaintext highlighter-rouge">on_use</code> (voor de helm), en het gebruik van <strong><code class="language-plaintext highlighter-rouge">minetest.after</code></strong> voor herhaling. Zoek in de API vooral eens naar <code class="language-plaintext highlighter-rouge">minetest.set_node</code> (om te begrijpen hoe we nodes plaatsen/vervangen in de wereld) en naar voorbeelden van globalstep of loop voor continu effect. Het concept van de <code class="language-plaintext highlighter-rouge">after</code> die zichzelf weer aanroept is een manier om een soort loop te maken. In documentatie-termen zou je ook kunnen zoeken op <em>“Minetest dynamic light”</em> om te zien hoe anderen lopende licht hebben aangepakt.</p>

<h3 id="oefeningen-4">Oefeningen</h3>

<p>Probeer weer wat variaties om het nog beter te begrijpen:</p>

<ol>
  <li><strong>Lichtsterkte aanpassen:</strong> In <code class="language-plaintext highlighter-rouge">register_node</code> hebben we <code class="language-plaintext highlighter-rouge">light_source = minetest.LIGHT_MAX</code> gebruikt (dat is 14, de max). Je kunt in plaats daarvan bijvoorbeeld 10 of 7 zetten om een zwakker licht te geven. Test het in het spel (donkere omgeving) en kijk hoeveel verschil het maakt.</li>
  <li><strong>Interval veranderen:</strong> We plaatsen elke seconde (<code class="language-plaintext highlighter-rouge">minetest.after(1, ...)</code>). Als je dit sneller doet (bijv. 0.2 seconden), zal het licht waarschijnlijk vloeiender meebewegen, maar dat is wellicht overkill. Probeer eens 2 seconden: je krijgt dan merkbaar vertraagde lichtvolging (je loopt iets voor het licht uit). Experimenteer met de timing.</li>
  <li><strong>Lichtspoor opruimen (uitdaging):</strong> Denk na over hoe je de achtergebleven lichtblokjes zou kunnen verwijderen als de helm wordt afgezet. (Hint: je zou de posities kunnen bijhouden in een lijst telkens als je er een plaatst, en als je helm_active false wordt, die posities doorlopen en de blokjes vervangen door lucht. Dit is best gevorderd, dus alleen doen als je meer wilt programmeren.)</li>
  <li><strong>Andere armor-effecten:</strong> Nu je weet hoe dit werkt, kun je een vergelijkbare mod maken voor andere grappige effecten. Bijvoorbeeld een <strong>“mijnwerkershelm”</strong> van een torch + steel die licht geeft (lijkt op deze), of een <strong>speed boots</strong> (laarzen die je sneller laten lopen). Voor het laatste zou je bij on_use de speler snelheid physics_override kunnen verhogen zolang het actief is, vergelijkbaar met hoe we de helm activeerden.</li>
  <li><strong>Combineer met eerdere mods:</strong> Draag je dirt-helm terwijl je de vliegen-potion gebruikt en ’s nachts door de lucht vliegt – als het goed is, verlicht je als een vallende ster de omgeving! Of zet de helm op en gebruik de feather fall potion in een donkere grot om langzaam neer te dalen met licht. Zie je hoe de verschillende mods elkaar aanvullen?</li>
</ol>

<p>Super! Je hebt nu een mod gemaakt die een nieuw item (helm) en een nieuw node (licht) toevoegt en deze laat samenwerken. Dit was een wat ingewikkelder voorbeeld, maar hopelijk vond je het leuk om te zien hoe je creatief de spelwereld kunt manipuleren. In het volgende hoofdstuk gaan we door met armor-ideeën: we maken een gravel armor dat je immuun maakt voor schade.</p>

<hr />

<h2 id="hoofdstuk-6-gravel-armor-voor-onschendbaarheid">Hoofdstuk 6: Gravel-armor voor onschendbaarheid</h2>

<p><strong>Wat ga je leren?</strong> In dit hoofdstuk maken we weer een stukje “armor” – dit keer een harnas van gravel dat je immuun maakt voor schade. Dat betekent dat als je dit pantser draagt, vijanden je niet kunnen verwonden (en idealiter val- of laverschade ook niet werkt). We bouwen voort op de vorige aanpak (een item dat je activeert om een effect te toggelen). Het nieuwe dat je leert is hoe je de <em>schadegroepen</em> van de speler kunt aanpassen, zodat hij/zij geen schade meer krijgt. Ook hier komt een craft en test aan bod, met wat oefeningen.</p>

<h3 id="modstructuur-2">Modstructuur</h3>

<p>Maak een nieuwe mod map <code class="language-plaintext highlighter-rouge">gravel_armor</code>. In feite lijkt het op de dirt_armor structuur, maar we hebben geen speciale node nodig deze keer, alleen het item:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gravel_armor/
├── init.lua
├── mod.conf
└── textures/
    └── gravel_chestplate.png   (icoon voor het gravel pantser)
</code></pre></div></div>

<p>In <code class="language-plaintext highlighter-rouge">mod.conf</code>:</p>
<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="py">name</span> <span class="p">=</span> <span class="s">gravel_armor</span>
<span class="py">depends</span> <span class="p">=</span> <span class="s">default</span>
</code></pre></div></div>

<p>Teken een icoontje voor een borstpantser van steentjes (gravel). Je kunt bijvoorbeeld de standaard gravel-textuur als basis nemen en er de vorm van een harnas in aangeven. Of gebruik je fantasie (een grijze vest-achtige vorm). Als je niet tekent, kun je altijd een placeholder nemen (bijv. <code class="language-plaintext highlighter-rouge">"default_stone.png"</code> als beeld – al klopt dat niet echt met gravel, maar goed).</p>

<h3 id="code-pantser-dat-schade-negeert">Code: pantser dat schade negeert</h3>

<p>Open <code class="language-plaintext highlighter-rouge">init.lua</code> van <code class="language-plaintext highlighter-rouge">gravel_armor</code> en schrijf deze code:</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Tabel om bij te houden bij welke spelers het gravel pantser actief is</span>
<span class="kd">local</span> <span class="n">armor_active</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1">-- Registreer het gravel chestplate item</span>
<span class="n">minetest</span><span class="p">.</span><span class="n">register_craftitem</span><span class="p">(</span><span class="s2">"gravel_armor:chestplate"</span><span class="p">,</span> <span class="p">{</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">"Gravel Pantser (onschendbaar)"</span><span class="p">,</span>
    <span class="n">inventory_image</span> <span class="o">=</span> <span class="s2">"gravel_chestplate.png"</span><span class="p">,</span>
    <span class="n">on_use</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="n">itemstack</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">pointed_thing</span><span class="p">)</span>
        <span class="kd">local</span> <span class="n">player</span> <span class="o">=</span> <span class="n">user</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">player</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">player</span><span class="p">:</span><span class="n">is_player</span><span class="p">()</span> <span class="k">then</span>
            <span class="k">return</span> <span class="n">itemstack</span>
        <span class="k">end</span>
        <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="n">player</span><span class="p">:</span><span class="n">get_player_name</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">armor_active</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">then</span>
            <span class="c1">-- Pantser was aan, nu uitzetten</span>
            <span class="n">armor_active</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">nil</span>
            <span class="c1">-- Zet speler terug naar normale kwetsbaarheid</span>
            <span class="n">player</span><span class="p">:</span><span class="n">set_armor_groups</span><span class="p">({</span><span class="n">fleshy</span> <span class="o">=</span> <span class="mi">100</span><span class="p">})</span>
            <span class="n">minetest</span><span class="p">.</span><span class="n">chat_send_player</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">"Je doet het gravel pantser uit. (Je bent niet langer onschendbaar.)"</span><span class="p">)</span>
        <span class="k">else</span>
            <span class="c1">-- Pantser stond uit, nu aandoen</span>
            <span class="n">armor_active</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span>
            <span class="c1">-- Zet speler's armor group zo dat hij geen schade krijgt</span>
            <span class="n">player</span><span class="p">:</span><span class="n">set_armor_groups</span><span class="p">({</span><span class="n">fleshy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">})</span>
            <span class="n">minetest</span><span class="p">.</span><span class="n">chat_send_player</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">"Je trekt het gravel pantser aan. (Je bent nu immuun voor schade!)"</span><span class="p">)</span>
        <span class="k">end</span>
        <span class="k">return</span> <span class="n">itemstack</span>
    <span class="k">end</span>
<span class="p">})</span>
</code></pre></div></div>

<p>En voeg ook weer een craftrecept toe, bijvoorbeeld in de vorm van een harnas (borstpantser):</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Recept: Gravel pantser (borstvorm - 8 stuks gravel)</span>
<span class="n">minetest</span><span class="p">.</span><span class="n">register_craft</span><span class="p">({</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s2">"gravel_armor:chestplate"</span><span class="p">,</span>
    <span class="n">recipe</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">{</span><span class="s2">"default:gravel"</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="s2">"default:gravel"</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">"default:gravel"</span><span class="p">,</span> <span class="s2">"default:gravel"</span><span class="p">,</span> <span class="s2">"default:gravel"</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">"default:gravel"</span><span class="p">,</span> <span class="s2">"default:gravel"</span><span class="p">,</span> <span class="s2">"default:gravel"</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre></div></div>

<p>Uitleg van de code:</p>
<ul>
  <li>We hebben een tabel <code class="language-plaintext highlighter-rouge">armor_active</code> om bij te houden welke spelers het pantser effect aan hebben, net zoals bij de helm.</li>
  <li>We registreren een item <code class="language-plaintext highlighter-rouge">gravel_armor:chestplate</code> met een beschrijving en plaatje.</li>
  <li>In <code class="language-plaintext highlighter-rouge">on_use</code>, als de speler het pantser gebruikt (rechtermuisknop), kijken we of hij al actief is.
    <ul>
      <li>Zo ja (pantser uitdoen): we halen de speler uit de tabel en zetten de <em>armor group</em> terug naar normaal: <code class="language-plaintext highlighter-rouge">player:set_armor_groups({fleshy = 100})</code>. In Minetest heeft de groep “fleshy” betrekking op levende wezens (inclusief de speler). Standaard is dat 100, wat betekent 100% schade ontvangen.</li>
      <li>Zo nee (pantser aandoen): we markeren active = true en zetten <code class="language-plaintext highlighter-rouge">player:set_armor_groups({fleshy = 0})</code>. Hiermee wordt de speler effectief onkwetsbaar voor normale schade, want alle inkomende schade op de fleshy-groep wordt met factor 0% vermenigvuldigd (0 dus).</li>
    </ul>
  </li>
  <li>We sturen telkens een chatbericht zodat de speler weet wat de status is.</li>
  <li>Het recept voor het pantser gebruikt 8 stukken gravel in een vorm die lijkt op een borstpantser (bovenste midden leeg, de rest gevuld), vergelijkbaar met Minecraft recept voor chestplate.</li>
</ul>

<h3 id="testen-in-minetest-5">Testen in Minetest</h3>

<ol>
  <li><strong>Mod activeren:</strong> Voeg <code class="language-plaintext highlighter-rouge">gravel_armor</code> toe en activeer in de wereld.</li>
  <li><strong>Pantser craften:</strong> Verzamel 8 gravel blokken (die vind je door grijze grindblokken te hakken, vaak bij water of in grotten). In de crafting grid plaats je ze:
    <ul>
      <li>Rij 1: [gravel][leeg][gravel]</li>
      <li>Rij 2: [gravel][gravel][gravel]</li>
      <li>Rij 3: [gravel][gravel][gravel]
Dit geeft het Gravel Pantser.</li>
    </ul>
  </li>
  <li><strong>Pantser aandoen:</strong> Zorg dat je niet in creative mode bent (want in creative krijg je sowieso geen schade). Doe het pantser in de hand en klik rechts. Je ziet een melding dat je immuun bent voor schade.</li>
  <li><strong>Test onschendbaarheid:</strong> Dit is leuk om te testen met bijvoorbeeld vallen of een andere bron van schade:
    <ul>
      <li><strong>Valtest:</strong> Klim een eindje omhoog (10+ blokken) en spring naar beneden. Normaal zou je nu flinke schade krijgen of doodgaan. Met pantser aan zou je (bijna) geen hartjes verliezen. Merk je verschil? Waarschijnlijk blijf je op volle HP.</li>
      <li><strong>Lava test (wees voorzichtig):</strong> Als je lava in de wereld hebt, kun je proberen er even in te stappen. Met pantser zou je geen of minimaal schade moeten krijgen (lava schade is iets anders dan fysiek, maar meestal valt ook onder fleshy geloof ik). Doe dit niet te lang of buiten creative, anders kun je alsnog overlijden als iets toch door komt.</li>
      <li><strong>Mobs/PvP test:</strong> Als je een monster-mod of een tweede speler beschikbaar hebt, laat ze je slaan. Normaal doet dat pijn, maar met pantser aan zou je geen hartjes verliezen.</li>
    </ul>
  </li>
  <li><strong>Pantser uitdoen:</strong> Klik nogmaals rechts met het item. Je krijgt bericht dat je niet langer onschendbaar bent. Probeer nu nogmaals van hoogte te vallen (maar misschien niet té hoog 😉) en zie dat je nu weer wel schade oploopt.</li>
</ol>

<p><strong>Let op:</strong> Dit pantser maakt je niet immuun voor alle mogelijke soorten schade. Het verandert de “fleshy” (levende) schade. Dit dekt slagen, vallen grotendeels en veel mob-aanvallen. Er zijn schades die misschien anders werken (zoals verstikking, vallen in de leegte, of speciale mods met eigen schade). Maar in algemeen survival-gebruik ben je nu heel moeilijk kapot te krijgen.</p>

<p>Ook is dit pantser in/uit zetten iets wat de speler handmatig doet. In een echte game zou je misschien willen dat zolang het item in een speciale “wear” slot zit het effect heeft. Dat vereist een echt armor-systeem mod. Onze benadering is simpel maar effectief voor demonstratie.</p>

<h3 id="verwijzing-naar-documentatie-5">Verwijzing naar documentatie</h3>

<p>Belangrijke trefwoorden uit deze code om op te zoeken: <strong><code class="language-plaintext highlighter-rouge">set_armor_groups</code></strong> en specifiek hoe de “fleshy” group werkt. De waarde 0 betekent geen schade, 100 normaal, &gt;100 betekent extra kwetsbaar, &lt;100 maar &gt;0 betekent verminderd maar niet nul. Je kunt hierover meer lezen bij de Object eigenschappen of player object in de API docs. Zoek bijvoorbeeld op <em>Minetest player set_armor_groups fleshy</em> om wat discussies en uitleg te vinden.</p>

<h3 id="oefeningen-5">Oefeningen</h3>

<p>Speel weer met de code en bedenk nieuwe dingen:</p>

<ol>
  <li><strong>Half damage:</strong> In plaats van volledig immuun (0), stel <code class="language-plaintext highlighter-rouge">fleshy = 50</code> in bij aantrekken. Dan krijg je 50% schade. Test dat eens: val van een bepaalde hoogte met pantser uit, zie hoeveel harten eraf gaan, en val van dezelfde hoogte met pantser aan (50) en kijk of het ongeveer de helft is. Interessant om mee te experimenteren.</li>
  <li><strong>Auto-uitschakelen (gevorderd):</strong> Zou je de mod zo kunnen aanpassen dat het pantser na een tijdje vanzelf uitgaat? Bijvoorbeeld na 30 seconden onkwetsbaarheid dat het effect stopt (misschien om het niet te sterk te maken). Je zou conceptueel iets met <code class="language-plaintext highlighter-rouge">minetest.after</code> kunnen doen wanneer iemand het aandoet, dat na X seconden weer fleshy=100 zet voor die speler en <code class="language-plaintext highlighter-rouge">armor_active[name] = nil</code>. Probeer dit te bedenken of implementeren.</li>
  <li><strong>Indicator op HUD (zeer moeilijk):</strong> Als extra uitdaging voor later: je zou bv. een HUD-icoontje kunnen tonen zolang pantser actief is (een schild-icoon op het scherm). Dat kennis bouwt voort op wat we in hoofdstuk 8 gaan doen, maar bedenk het vast als concept.</li>
  <li><strong>Nieuw pantseridee:</strong> Maak op dezelfde manier een ander soort pantser met een ander effect. Bijvoorbeeld <strong>“lava armor”</strong> dat je immuun maakt voor vuur/lava (maar dat vereist wellicht ook de “hot” damage group). Of <strong>“water armor”</strong> dat ervoor zorgt dat je onder water niet verdrinkt (dat is weer iets met breath misschien). Sommige dingen zijn moeilijker, maar je kunt creatief nadenken wat je met <code class="language-plaintext highlighter-rouge">player:set_properties</code> of andere functies zou kunnen aanpassen.</li>
  <li><strong>Test in multiplayer:</strong> (Hiervoor heb je een vriend nodig of je moet twee Minetest instances draaien.) Laat de ene speler het pantser dragen en kijk of de andere speler hem/haar geen schade kan doen in PvP. Dat is een leuke manier om je mod in actie te zien met twee mensen. Dit sluit ook mooi aan op hoofdstuk 9 straks.</li>
</ol>

<p>Goed bezig! Je hebt nu geleerd hoe je de eigenschappen van een speler (zoals schadeweerstand) kunt aanpassen met een mod. Dit opent de deur naar allerlei “superkracht”-mods. In het volgende hoofdstuk gaan we een heel ander soort item maken: <strong>speciale zwaarden</strong> met gekke effecten bij gebruik. Laten we onze creativiteit daar eens op loslaten!</p>

<hr />

<h2 id="hoofdstuk-7-twee-speciale-zwaarden-maken">Hoofdstuk 7: Twee speciale zwaarden maken</h2>

<p><strong>Wat ga je leren?</strong> In dit hoofdstuk gaan we iets stoers maken: <strong>speciale zwaarden</strong> met unieke krachten. We verzinnen twee creatieve voorbeelden van zwaarden en implementeren ze allebei in één mod. Hierdoor leer je hoe je tools (gereedschappen/wapens) registreert, hoe je hun <em>attack</em> eigenschappen kunt instellen en vooral hoe je bij gebruik of hit iets speciaals laat gebeuren. We doen twee voorbeelden om te laten zien dat je fantasie de limiet is. De voorbeelden die we gaan maken:</p>
<ol>
  <li>Een <strong>Regenboogzwaard</strong> – dit zwaard tovert ieder blok dat je ermee slaat om in een willekeurige kleur wol.</li>
  <li>Een <strong>Teleportatiezwaard</strong> – dit zwaard teleporteert jou een stukje in de kijkrichting wanneer je het gebruikt.</li>
</ol>

<p>We laten weer de modstructuur zien, de code voor beide zwaarden, en hoe te testen. Daarna kun je zelf vast nog meer gekke zwaarden bedenken!</p>

<h3 id="modstructuur-3">Modstructuur</h3>

<p>Maak een mod map <code class="language-plaintext highlighter-rouge">special_swords</code>. In deze mod maken we twee items (zwaarden), elk met hun eigen texture. Ook kunnen we craft recepten voorzien als je wilt. Structuur:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>special_swords/
├── init.lua
├── mod.conf
└── textures/
    ├── rainbow_sword.png        (icoon voor regenboogzwaard)
    └── teleporter_sword.png     (icoon voor teleportatiezwaard)
</code></pre></div></div>

<p>In <code class="language-plaintext highlighter-rouge">mod.conf</code>:</p>
<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="py">name</span> <span class="p">=</span> <span class="s">special_swords</span>
<span class="py">depends</span> <span class="p">=</span> <span class="s">default</span>
</code></pre></div></div>
<p>We depend op default omdat we wellicht default:wool en andere standaard items gebruiken.</p>

<p>Maak twee 16x16 px plaatjes voor de zwaarden. Bijvoorbeeld:</p>
<ul>
  <li>Regenboogzwaard: je kunt een zwaardvorm tekenen met regenboogstrepen erin.</li>
  <li>Teleportatiezwaard: misschien een paars/blauw zwaard om teleportatie te suggereren.</li>
</ul>

<p>Als tekenen niet je ding is, kun je ook placeholders gebruiken (bv. neem de default sword icon uit Minetest Game als basis als je die kunt vinden, of maak allemaal een effen kleur). Het gaat om het idee.</p>

<h3 id="code-twee-zwaarden-met-bijzondere-krachten">Code: Twee zwaarden met bijzondere krachten</h3>

<p>Open <code class="language-plaintext highlighter-rouge">init.lua</code> in de <code class="language-plaintext highlighter-rouge">special_swords</code> folder en typ onderstaande code. We registreren twee tools (let op, dit keer geen <code class="language-plaintext highlighter-rouge">craftitem</code> maar <code class="language-plaintext highlighter-rouge">register_tool</code>, wat beter past bij wapens).</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Regenboogzwaard: Verandert blokken in willekeurige gekleurde wol bij hit</span>
<span class="n">minetest</span><span class="p">.</span><span class="n">register_tool</span><span class="p">(</span><span class="s2">"special_swords:rainbow_sword"</span><span class="p">,</span> <span class="p">{</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">"Regenboogzwaard"</span><span class="p">,</span>
    <span class="n">inventory_image</span> <span class="o">=</span> <span class="s2">"rainbow_sword.png"</span><span class="p">,</span>
    <span class="n">tool_capabilities</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">full_punch_interval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">damage_groups</span> <span class="o">=</span> <span class="p">{</span><span class="n">fleshy</span> <span class="o">=</span> <span class="mi">4</span><span class="p">},</span>  <span class="c1">-- doet schade vergelijkbaar met een steel sword</span>
    <span class="p">},</span>
    <span class="n">on_use</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="n">itemstack</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">pointed_thing</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pointed_thing</span> <span class="ow">and</span> <span class="n">pointed_thing</span><span class="p">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">"node"</span> <span class="k">then</span>
            <span class="c1">-- Speler richt op een blok</span>
            <span class="kd">local</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">pointed_thing</span><span class="p">.</span><span class="n">under</span>
            <span class="kd">local</span> <span class="n">node</span> <span class="o">=</span> <span class="n">minetest</span><span class="p">.</span><span class="n">get_node</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">node</span> <span class="ow">and</span> <span class="n">node</span><span class="p">.</span><span class="n">name</span> <span class="o">~=</span> <span class="s2">"air"</span> <span class="k">then</span>
                <span class="c1">-- Lijst van beschikbare kleuren wol in default</span>
                <span class="kd">local</span> <span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"white"</span><span class="p">,</span> <span class="s2">"grey"</span><span class="p">,</span> <span class="s2">"black"</span><span class="p">,</span> <span class="s2">"red"</span><span class="p">,</span> <span class="s2">"yellow"</span><span class="p">,</span> <span class="s2">"green"</span><span class="p">,</span> <span class="s2">"cyan"</span><span class="p">,</span> <span class="s2">"blue"</span><span class="p">,</span> <span class="s2">"magenta"</span><span class="p">,</span> <span class="s2">"orange"</span><span class="p">,</span> <span class="s2">"brown"</span><span class="p">,</span> <span class="s2">"pink"</span><span class="p">,</span> <span class="s2">"dark_grey"</span><span class="p">,</span> <span class="s2">"dark_green"</span><span class="p">}</span>
                <span class="kd">local</span> <span class="n">rand_color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span> <span class="nb">math.random</span><span class="p">(</span><span class="o">#</span><span class="n">colors</span><span class="p">)</span> <span class="p">]</span>
                <span class="c1">-- Verander het blok in een gekleurd wol blok</span>
                <span class="n">minetest</span><span class="p">.</span><span class="n">set_node</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="p">{</span><span class="n">name</span> <span class="o">=</span> <span class="s2">"wool:"</span> <span class="o">..</span> <span class="n">rand_color</span><span class="p">})</span>
            <span class="k">end</span>
        <span class="k">end</span>
        <span class="k">return</span> <span class="n">itemstack</span>
    <span class="k">end</span>
<span class="p">})</span>

<span class="c1">-- Teleportatiezwaard: Teleporteert de speler een stukje in de kijkrichting bij gebruik</span>
<span class="n">minetest</span><span class="p">.</span><span class="n">register_tool</span><span class="p">(</span><span class="s2">"special_swords:teleporter_sword"</span><span class="p">,</span> <span class="p">{</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">"Teleportatiezwaard"</span><span class="p">,</span>
    <span class="n">inventory_image</span> <span class="o">=</span> <span class="s2">"teleporter_sword.png"</span><span class="p">,</span>
    <span class="n">tool_capabilities</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">full_punch_interval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">damage_groups</span> <span class="o">=</span> <span class="p">{</span><span class="n">fleshy</span> <span class="o">=</span> <span class="mi">6</span><span class="p">},</span>  <span class="c1">-- iets sterker basis schade</span>
    <span class="p">},</span>
    <span class="n">on_use</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="n">itemstack</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">pointed_thing</span><span class="p">)</span>
        <span class="kd">local</span> <span class="n">player</span> <span class="o">=</span> <span class="n">user</span>
        <span class="k">if</span> <span class="n">player</span> <span class="k">then</span>
            <span class="c1">-- Bepaal kijkrichting en teleport speler 10 blokken die kant op</span>
            <span class="kd">local</span> <span class="n">dir</span> <span class="o">=</span> <span class="n">player</span><span class="p">:</span><span class="n">get_look_dir</span><span class="p">()</span>   <span class="c1">-- genormaliseerde richting vector</span>
            <span class="kd">local</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">player</span><span class="p">:</span><span class="n">get_pos</span><span class="p">()</span>
            <span class="c1">-- Teleporteer naar nieuwe positie: huidige pos + 10 * richting vector</span>
            <span class="kd">local</span> <span class="n">newpos</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">pos</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">dir</span><span class="p">.</span><span class="n">x</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">pos</span><span class="p">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">dir</span><span class="p">.</span><span class="n">y</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span>
                <span class="n">z</span> <span class="o">=</span> <span class="n">pos</span><span class="p">.</span><span class="n">z</span> <span class="o">+</span> <span class="n">dir</span><span class="p">.</span><span class="n">z</span> <span class="o">*</span> <span class="mi">10</span>
            <span class="p">}</span>
            <span class="c1">-- Controle: we willen niet binnenin een blok teleporteren als het kan</span>
            <span class="kd">local</span> <span class="n">node</span> <span class="o">=</span> <span class="n">minetest</span><span class="p">.</span><span class="n">get_node</span><span class="p">(</span><span class="n">newpos</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">node</span><span class="p">.</span><span class="n">name</span> <span class="o">~=</span> <span class="s2">"air"</span> <span class="k">then</span>
                <span class="c1">-- Als doelpositie niet leeg is, verhoog Y totdat leeg (simpel uitweg)</span>
                <span class="k">while</span> <span class="n">node</span><span class="p">.</span><span class="n">name</span> <span class="o">~=</span> <span class="s2">"air"</span> <span class="ow">and</span> <span class="n">newpos</span><span class="p">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">pos</span><span class="p">.</span><span class="n">y</span> <span class="o">+</span> <span class="mi">20</span> <span class="k">do</span>
                    <span class="n">newpos</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">newpos</span><span class="p">.</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="n">node</span> <span class="o">=</span> <span class="n">minetest</span><span class="p">.</span><span class="n">get_node</span><span class="p">(</span><span class="n">newpos</span><span class="p">)</span>
                <span class="k">end</span>
            <span class="k">end</span>
            <span class="n">player</span><span class="p">:</span><span class="n">set_pos</span><span class="p">(</span><span class="n">newpos</span><span class="p">)</span>
        <span class="k">end</span>
        <span class="k">return</span> <span class="n">itemstack</span>
    <span class="k">end</span>
<span class="p">})</span>
</code></pre></div></div>

<p>Laten we de code in woorden uitleggen:</p>
<ul>
  <li><strong>Regenboogzwaard</strong> (<code class="language-plaintext highlighter-rouge">special_swords:rainbow_sword</code>):
    <ul>
      <li><code class="language-plaintext highlighter-rouge">register_tool</code> lijkt op register_craftitem maar is bedoeld voor gereedschappen/wapens. We geven <code class="language-plaintext highlighter-rouge">tool_capabilities</code> mee, zodat het zwaard schade kan doen als een normaal zwaard. <code class="language-plaintext highlighter-rouge">damage_groups = {fleshy = 4}</code> betekent 4 hitpoints schade (2 hartjes) aan spelers/mobs. <code class="language-plaintext highlighter-rouge">full_punch_interval</code> is hoe snel je achter elkaar kunt slaan (1.0 seconde hier).</li>
      <li><code class="language-plaintext highlighter-rouge">on_use</code> wordt aangeroepen bij rechtsklik (of linkerklik op niks) met het item. We checken <code class="language-plaintext highlighter-rouge">pointed_thing</code>: dit geeft info over wat de speler richt bij gebruik. We kijken of <code class="language-plaintext highlighter-rouge">pointed_thing.type == "node"</code>, d.w.z. de speler richt op een blok in de wereld.</li>
      <li><code class="language-plaintext highlighter-rouge">pointed_thing.under</code> is de positie van het blok dat aangeklikt/bekeken wordt. We halen de node daar.</li>
      <li>Als het geen lucht is (dus er is een blok), dan bepalen we een willekeurige kleur uit een lijst van wol-kleuren (alle kleuren die in default:wool mod zitten).</li>
      <li>Met <code class="language-plaintext highlighter-rouge">minetest.set_node(pos, {name = "wool:kleurnaam"})</code> veranderen we dat blok in een gekleurd wolblok.</li>
      <li>Gevolg: als je met het regenboogzwaard op een blok slaat (rechtermuisknop in dit geval), tover je dat blok om in een vrolijk gekleurd wolletje! 🌈 (Opmerking: We hebben het hier op on_use gezet zodat je niet per ongeluk de hele wereld in wol verandert als je probeert blokken te hakken. Je moet dus bewust rechtsklikken. In survival zul je met links slaan om een blok te hakken, dat zou ook door de engine gebeuren maar we onderscheppen het niet. Rechtsklik is meer “gebruik speciaal”.)</li>
    </ul>
  </li>
  <li><strong>Teleportatiezwaard</strong> (<code class="language-plaintext highlighter-rouge">special_swords:teleporter_sword</code>):
    <ul>
      <li>Ook hier een register_tool met wat hogere damage (6 = 3 hartjes, bijv. als een diamant zwaard).</li>
      <li>In <code class="language-plaintext highlighter-rouge">on_use</code>, ongeacht waar je op mikt (mag ook de lucht zijn), pakken we de speler en bepalen de kijkrichting met <code class="language-plaintext highlighter-rouge">get_look_dir()</code>. Dat geeft een richtingvector (x,y,z) waarvan de lengte 1 is.</li>
      <li>We pakken de huidige positie van de speler en voegen de richting maal 10 eraan toe om een positie 10 blokken verder in die richting te krijgen. Dus als je naar voren kijkt en gebruik, dan ga je 10 meter vooruit. Kijk je omhoog, ga je diagonaal omhoog, etc.</li>
      <li>We doen een kleine check: als de plek waar je uitkomt niet in de lucht is (<code class="language-plaintext highlighter-rouge">~= "air"</code>), verhogen we de <code class="language-plaintext highlighter-rouge">newpos.y</code> stapsgewijs tot we boven het obstakel zijn (of tot max 20 blokken hoger dan start). Dit om te voorkomen dat je in een berg of muur vast komt te zitten. (Het is simpel gehouden – er zijn betere manieren zoals raycast, maar dat is gevorderd.)</li>
      <li>Daarna zetten we de spelerpositie naar newpos met <code class="language-plaintext highlighter-rouge">player:set_pos(newpos)</code>. Bam, je bent geteleporteerd!</li>
      <li>Noot: We doen dit op on_use (rechterklik). Linksklikken met dit zwaard zal gewoon schade doen aan mobs/spelers via de normale melee (damage_groups), zonder teleporteffect. Dus je kunt zowel vechten met het zwaard als jezelf verplaatsen met rechtsklik.</li>
    </ul>
  </li>
</ul>

<p>Nu nog optioneel: craft recepten voor deze zwaarden. Dit kun je verzinnen – bijvoorbeeld:</p>
<ul>
  <li>Regenboogzwaard craften uit 1 staal zwaard + 3 verschillend gekleurde wolblokken?</li>
  <li>Teleportatiezwaard craften uit 1 mese kristal + 1 staal zwaard?</li>
</ul>

<p>We doen even eenvoudige recepten:</p>
<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Recepten voor de speciale zwaarden</span>
<span class="n">minetest</span><span class="p">.</span><span class="n">register_craft</span><span class="p">({</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s2">"special_swords:rainbow_sword"</span><span class="p">,</span>
    <span class="n">recipe</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">{</span><span class="s2">""</span><span class="p">,</span> <span class="s2">"wool:red"</span><span class="p">,</span> <span class="s2">""</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">"wool:blue"</span><span class="p">,</span> <span class="s2">"default:sword_steel"</span><span class="p">,</span> <span class="s2">"wool:green"</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">""</span><span class="p">,</span> <span class="s2">"wool:yellow"</span><span class="p">,</span> <span class="s2">""</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">})</span>
<span class="n">minetest</span><span class="p">.</span><span class="n">register_craft</span><span class="p">({</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s2">"special_swords:teleporter_sword"</span><span class="p">,</span>
    <span class="n">recipe</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">{</span><span class="s2">""</span><span class="p">,</span> <span class="s2">"default:mese_crystal"</span><span class="p">,</span> <span class="s2">""</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">""</span><span class="p">,</span> <span class="s2">"default:sword_steel"</span><span class="p">,</span> <span class="s2">""</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">""</span><span class="p">,</span> <span class="s2">"default:diamond"</span><span class="p">,</span> <span class="s2">""</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre></div></div>

<p>Hier stellen we voor:</p>
<ul>
  <li>Regenboogzwaard: een staalzwaard omringd door 4 gekleurde wol (rood, blauw, groen, geel in een ruitvorm).</li>
  <li>Teleportatiezwaard: een staalzwaard onder een mese crystal en boven een diamant (want magisch en waardevol 😃).</li>
</ul>

<h3 id="testen-in-minetest-6">Testen in Minetest</h3>

<ol>
  <li><strong>Mod activeren:</strong> Voeg <code class="language-plaintext highlighter-rouge">special_swords</code> toe aan mods en activeer in de wereld.</li>
  <li><strong>Zwaarden craften of verkrijgen:</strong> Als je de benodigde spullen hebt, kun je de recepten volgen:
    <ul>
      <li>Regenboogzwaard: je hebt een staalzwaard (iron sword), en rode, blauwe, groene, gele wol nodig. (Wol kun je krijgen via de dye mod of door schapen als je mobs hebt, maar je kunt ook creative mode inschakelen om het te testen makkelijk.)</li>
      <li>Teleportatiezwaard: je hebt een staalzwaard, een mese kristal en een diamant nodig.
<em>Tip:</em> Je mag gerust in creative mode de items gewoon uit de menu halen om te testen als het verzamelen teveel werk is. Zoek op “Regenboogzwaard” en “Teleportatiezwaard” in de itemlijst. Of gebruik <code class="language-plaintext highlighter-rouge">/give</code> commando: <code class="language-plaintext highlighter-rouge">/give naam special_swords:rainbow_sword</code>.</li>
    </ul>
  </li>
  <li><strong>Regenboogzwaard uitproberen:</strong> Neem het regenboogzwaard in de hand. Zoek een plek met allerlei soorten blokken. Klik met rechts op bijvoorbeeld een grasblok, een steen, een boomstam, etc. Je zult zien dat het blok waar je op klikt <strong>verandert in een random kleur wol</strong>! Probeer het een paar keer op dezelfde plek en je ziet verschillende kleuren verschijnen. Het werkt op vrijwel elk blok (pas wel op: het verandert ook kisten of machines als die gewoon blokken zijn – dus niet op je opslag klikken 😅). Dit zwaard doet dus geen speciale particles ofzo, maar de wereld inkleuren is al leuk.</li>
  <li><strong>Teleportatiezwaard uitproberen:</strong> Neem het teleportatiezwaard in de hand. Kijk in een bepaalde richting (bijv. op de grond ver voor je, of naar de horizon) en klik rechts. Je zou plots 10 blokken verderop moeten staan! Het voelt alsof je flitst/warpt. Kijk omhoog en gebruik – je gaat omhoog (en valt daarna weer naar beneden tenzij je snel opnieuw gebruikt of de feather fall potion gebruikt 😉). Kijk naar een muur en gebruik: als onze code werkt, zou je bovenop de muur belanden in plaats van er middenin. Speel hiermee rond: je kunt je als nachtcrawler teleporteren over korte afstanden.</li>
  <li><strong>Combat testen:</strong> Beide zwaarden hebben ook schade. Je kunt in survival proberen een dier of monster te slaan met links: regenboogzwaard doet normale schade (maar <em>ook</em> zal het de blokken die je aanklikt met rechts veranderen, grappig effect als je een mod hebt waar monsters blokken neerzetten ofzo, maar dat is uitzonderlijk). Teleportatiezwaard doet iets meer schade. Test in creatieve scenario’s of met vrienden (zie hoofdstuk 9) hoe het is om deze zwaarden te gebruiken in gevecht. Misschien kun je een vriendje verassen door snel weg te teleporteren als hij je aanvalt!</li>
  <li><strong>Gek combinaties:</strong> Probeer eens het regenboogzwaard op verschillende structuren: verander een huis in regenboog-wol! Of spring een ravijn in en teleporteer halverwege naar de zijkant met het teleport-sword.</li>
</ol>

<h3 id="verwijzing-naar-documentatie-6">Verwijzing naar documentatie</h3>

<p>Enkele API onderwerpen die hier gebruikt zijn:</p>
<ul>
  <li><strong><code class="language-plaintext highlighter-rouge">minetest.register_tool</code></strong> – zoek hierop om te lezen over tool_capabilities (er zijn ook meer instellingen zoals gebruiksslijtage etc., die we nu niet deden).</li>
  <li><strong><code class="language-plaintext highlighter-rouge">pointed_thing</code></strong> – dit is een belangrijk concept. Zoek op <em>Minetest pointed_thing</em> om te zien hoe het werkt bij on_use en on_punch.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">minetest.get_look_dir</code></strong> en vectorberekeningen: Als je dit verder wilt uitbouwen, lees over <em>ObjectRef:get_look_dir()</em> en ook <em>minetest.raycast</em> (voor geavanceerde teleport-checking).</li>
  <li><strong>Wol kleuren</strong>: We gebruikten namen uit default wool mod. Je kunt op de Minetest wiki de lijst van kleurnamen vinden als je wilt uitbreiden (we hebben de meesten).</li>
  <li><strong><code class="language-plaintext highlighter-rouge">minetest.set_node</code></strong> weer even, dat kwam eerder ook voor.</li>
</ul>

<h3 id="oefeningen-6">Oefeningen</h3>

<p>Nu ben jij de smid van legendarische zwaarden! Probeer:</p>

<ol>
  <li><strong>Verander de wolkleuren:</strong> Pas de lijst van kleuren aan. Voeg er bijvoorbeeld “violet” of “dark_blue” aan toe (als die bestaan in wool mod). Of laat het zwaard niet in <em>alle</em> kleuren kunnen veranderen maar kies uit een paar specifieke (bijv. alleen warme kleuren).</li>
  <li><strong>Teleport afstand variëren:</strong> Wij kozen 10 blokken. Verander dat naar 5 of 20 en test. Pas ook de <code class="language-plaintext highlighter-rouge">while</code> check aan als je veel verder gaat, zodat je niet alsnog in een berg komt vast te zitten.</li>
  <li><strong>Nieuw speciaal zwaard bedenken:</strong> Gebruik deze twee als voorbeeld en verzin je eigen:
    <ul>
      <li>Bijvoorbeeld een <strong>Vuurzwaard</strong> dat elke mob of speler die je raakt in brand steekt (hint: je zou in <code class="language-plaintext highlighter-rouge">on_use</code> of misschien beter <code class="language-plaintext highlighter-rouge">on_secondary_use</code> een fire node op de plek van het slachtoffer kunnen plaatsen of hun HP reduceren over tijd).</li>
      <li>Of een <strong>Explosiezwaard</strong> dat bij impact een kleine explosie veroorzaakt (hint: <code class="language-plaintext highlighter-rouge">tnt.boom()</code> functie als de TNT mod actief is, of spawn een <code class="language-plaintext highlighter-rouge">fire:basic_flame</code> en <code class="language-plaintext highlighter-rouge">minetest.sound_play("explosion")</code>).</li>
      <li>Misschien een <strong>Summonzwaard</strong> dat een dier of monster spawnt waar je mee slaat (vereist een mobs mod).</li>
      <li>Of iets milders, een <strong>Hamer van groei</strong> die elke zaailing waar je op slaat in een boom verandert (je kunt een sapling vervangen door een fully grown tree using schematics misschien).
Laat je fantasie gaan! Begin simpel: kopieer de structuur van on_use van een van onze zwaarden en pas de actie aan.</li>
    </ul>
  </li>
  <li><strong>Balans de recepten:</strong> Denk na of de door ons gegeven craftrecepten eerlijk zijn voor wat het zwaard kan. Misschien zou regenboogzwaard duurder of juist goedkoper moeten, idem voor teleporter. Pas de recepten aan en bedenk waarom (goed argumenteren is ook belangrijk bij game design!).</li>
  <li><strong>Combineer met andere mods:</strong> Gebruik het regenboogzwaard terwijl je de dirt-helm draagt in een donkere grot: je verlicht de grot én schildert hem tegelijk! Of gebruik teleport-sword om supersnel verticale afstanden te overbruggen in combinatie met de feather fall potion, zodat je zacht landt na een hoge teleport. Dit is het leuke aan mods – jullie creaties werken samen.</li>
</ol>

<p>Gefeliciteerd, je hebt nu behoorlijk complexe items gemaakt! Hiermee heb je veel aspecten van modding geraakt: nieuwe items, blokken, effecten op de wereld en op spelers. In het volgende hoofdstuk gaan we nog iets heel anders doen: geen nieuwe items, maar de gebruikersinterface (HUD) aanpassen om een eigen statistiek weer te geven. Klaar om de HUD te hacken?</p>

<hr />

<h2 id="hoofdstuk-8-een-eigen-hud-statistiek-toevoegen-strength">Hoofdstuk 8: Een eigen HUD-statistiek toevoegen (Strength)</h2>

<p><strong>Wat ga je leren?</strong> In dit hoofdstuk kijken we naar de HUD (Heads-Up Display) – de informatie op het scherm, zoals harten, lucht, hotbar, etc. We gaan een eenvoudige eigen HUD-element toevoegen: een tekst die een waarde “Strength” (kracht) aangeeft. Daarnaast maken we een item (bijvoorbeeld een halter/dumbbell) waarmee de speler zijn Strength kan verhogen. Zo zie je hoe je dynamisch de HUD kunt updaten. Dit leert je hoe je iets op het scherm tekent via code, en hoe je data per speler kunt bijhouden.</p>

<h3 id="modstructuur-4">Modstructuur</h3>

<p>Maak een mod map <code class="language-plaintext highlighter-rouge">hud_strength</code>. In deze mod hebben we één init.lua en een texture voor onze dumbbell:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hud_strength/
├── init.lua
├── mod.conf
└── textures/
    └── dumbbell.png    (icoon voor de halter)
</code></pre></div></div>

<p>In <code class="language-plaintext highlighter-rouge">mod.conf</code>:</p>
<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="py">name</span> <span class="p">=</span> <span class="s">hud_strength</span>
<span class="py">depends</span> <span class="p">=</span> <span class="s">default</span>
</code></pre></div></div>
<p>(Mogelijk is default niet eens nodig hier, maar kan geen kwaad. Als we appels of staal gebruiken voor craft, is default nodig.)</p>

<p>Maak een klein plaatje <code class="language-plaintext highlighter-rouge">dumbbell.png</code> – bijvoorbeeld twee zwarte gewichten met een stang (denk aan een halter). Heel simpel kan het ook een grijse staaf zijn. Dit wordt het inventory icoon voor onze halter.</p>

<h3 id="code-hud-element-en-dumbbell-item">Code: HUD element en dumbbell item</h3>

<p>Open <code class="language-plaintext highlighter-rouge">init.lua</code> in <code class="language-plaintext highlighter-rouge">hud_strength</code> en schrijf de code:</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Houd bij per speler: strength waarde en HUD id</span>
<span class="kd">local</span> <span class="n">player_strength</span> <span class="o">=</span> <span class="p">{}</span>
<span class="kd">local</span> <span class="n">strength_hud_id</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1">-- Wanneer een speler joint, initialiseer de strength en HUD</span>
<span class="n">minetest</span><span class="p">.</span><span class="n">register_on_joinplayer</span><span class="p">(</span><span class="k">function</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
    <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="n">player</span><span class="p">:</span><span class="n">get_player_name</span><span class="p">()</span>
    <span class="c1">-- Beginwaarde Strength</span>
    <span class="n">player_strength</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1">-- Voeg HUD element toe voor de strength waarde</span>
    <span class="n">strength_hud_id</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">player</span><span class="p">:</span><span class="n">hud_add</span><span class="p">({</span>
        <span class="n">hud_elem_type</span> <span class="o">=</span> <span class="s2">"text"</span><span class="p">,</span>
        <span class="n">position</span>  <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">},</span>
        <span class="n">offset</span>    <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>   <span class="n">y</span><span class="o">=</span><span class="mi">20</span><span class="p">},</span>
        <span class="n">alignment</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>   <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">},</span>
        <span class="n">scale</span>     <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">100</span><span class="p">},</span>  <span class="c1">-- schaal van de tekst</span>
        <span class="n">text</span>      <span class="o">=</span> <span class="s2">"Strength: 0"</span><span class="p">,</span>
        <span class="n">number</span>    <span class="o">=</span> <span class="mh">0xFFFFFF</span><span class="p">,</span>       <span class="c1">-- witte tekst</span>
    <span class="p">})</span>
<span class="k">end</span><span class="p">)</span>

<span class="c1">-- Registreer een "halter" item om strength te verhogen</span>
<span class="n">minetest</span><span class="p">.</span><span class="n">register_craftitem</span><span class="p">(</span><span class="s2">"hud_strength:dumbbell"</span><span class="p">,</span> <span class="p">{</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">"Halter (verhoogt Strength)"</span><span class="p">,</span>
    <span class="n">inventory_image</span> <span class="o">=</span> <span class="s2">"dumbbell.png"</span><span class="p">,</span>
    <span class="n">on_use</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="n">itemstack</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">pointed_thing</span><span class="p">)</span>
        <span class="kd">local</span> <span class="n">player</span> <span class="o">=</span> <span class="n">user</span>
        <span class="k">if</span> <span class="n">player</span> <span class="k">then</span>
            <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="n">player</span><span class="p">:</span><span class="n">get_player_name</span><span class="p">()</span>
            <span class="c1">-- Verhoog de strength waarde</span>
            <span class="n">player_strength</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">player_strength</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="c1">-- Pas de HUD tekst aan</span>
            <span class="kd">local</span> <span class="n">new_text</span> <span class="o">=</span> <span class="s2">"Strength: "</span> <span class="o">..</span> <span class="n">player_strength</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="n">player</span><span class="p">:</span><span class="n">hud_change</span><span class="p">(</span><span class="n">strength_hud_id</span><span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="s2">"text"</span><span class="p">,</span> <span class="n">new_text</span><span class="p">)</span>
            <span class="c1">-- Misschien een leuk geluid of effect toevoegen (optioneel)</span>
        <span class="k">end</span>
        <span class="k">return</span> <span class="n">itemstack</span>
    <span class="k">end</span>
<span class="p">})</span>

<span class="c1">-- Voeg een recept toe voor de halter: (staaf van een stok en gewichten van staal?)</span>
<span class="n">minetest</span><span class="p">.</span><span class="n">register_craft</span><span class="p">({</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s2">"hud_strength:dumbbell"</span><span class="p">,</span>
    <span class="n">recipe</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">{</span><span class="s2">"default:steel_ingot"</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">"default:stick"</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">"default:steel_ingot"</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre></div></div>

<p>Uitgelegd:</p>
<ul>
  <li>We hebben twee tabellen: <code class="language-plaintext highlighter-rouge">player_strength</code> om de actuele sterkte per spelernaam op te slaan, en <code class="language-plaintext highlighter-rouge">strength_hud_id</code> om het ID van het HUD element op te slaan zodat we het later kunnen updaten.</li>
  <li><code class="language-plaintext highlighter-rouge">register_on_joinplayer</code>: zodra een speler de wereld betreedt:
    <ul>
      <li>We zetten hun strength op 0 in onze tabel.</li>
      <li>We voegen een HUD element toe met <code class="language-plaintext highlighter-rouge">player:hud_add({...})</code>. We kiezen <code class="language-plaintext highlighter-rouge">hud_elem_type = "text"</code> om tekst weer te geven. We plaatsen het element met <code class="language-plaintext highlighter-rouge">position = {x=0.5, y=0.0}</code> wat betekent middenboven aan het scherm (x=0.5 is horizontaal midden, y=0.0 is top). De <code class="language-plaintext highlighter-rouge">offset = {x=0, y=20}</code> duwt het iets naar beneden vanaf de bovenrand zodat het niet helemaal in de hoek plakt.</li>
      <li><code class="language-plaintext highlighter-rouge">alignment = {x=0, y=1}</code> zorgt dat de tekst gecentreerd wordt (x=0) en naar beneden gaat (y=1). Scale en offset zijn een beetje uitproberen; hier gebruiken we {100,100} zodat het een normale grootte heeft.</li>
      <li>De tekst beginnen we als “Strength: 0”. <code class="language-plaintext highlighter-rouge">number = 0xFFFFFF</code> kleurt de tekst wit (hexadecimaal voor RRGGBB).</li>
      <li><code class="language-plaintext highlighter-rouge">hud_add</code> geeft een id terug (integer) dat dat HUD element representeert. We slaan dat op in <code class="language-plaintext highlighter-rouge">strength_hud_id[name]</code>.</li>
    </ul>
  </li>
  <li>We registreren een item <code class="language-plaintext highlighter-rouge">dumbbell</code> (halter). In <code class="language-plaintext highlighter-rouge">on_use</code>:
    <ul>
      <li>We verhogen de strength in onze tabel voor de speler met +1.</li>
      <li>We bouwen een nieuwe tekststring “Strength: X” met de bijgewerkte waarde.</li>
      <li>Met <code class="language-plaintext highlighter-rouge">player:hud_change(strength_hud_id[name], "text", new_text)</code> veranderen we de bestaande HUD tekst naar de nieuwe waarde. Zo ziet de speler zijn Strength getal oplopen.</li>
      <li>We laten het item niet verbruiken (<code class="language-plaintext highlighter-rouge">return itemstack</code> zonder itemstack:take_item), zodat je de halter eindeloos kunt gebruiken om te trainen.</li>
      <li>(Je zou eventueel een limiet kunnen zetten of een cooldown, maar voor nu niet.)</li>
    </ul>
  </li>
  <li>Craftrecept: 1 steel ingot boven, 1 stick midden, 1 steel ingot onder – dit stelt een halter voor (de stang is de stick, de gewichten zijn de stalen schijven).</li>
</ul>

<h3 id="testen-in-minetest-7">Testen in Minetest</h3>

<ol>
  <li><strong>Mod activeren:</strong> Voeg <code class="language-plaintext highlighter-rouge">hud_strength</code> mod toe en activeer in de wereld.</li>
  <li><strong>Bij het joinen:</strong> Zodra je de wereld betreedt met je speler, zou je bovenin het scherm de tekst <strong>Strength: 0</strong> moeten zien staan (mogelijk half bovenin gecentreerd). Dit is jouw HUD element dat onze mod toevoegt.</li>
  <li><strong>Halter verkrijgen:</strong> Craft de halter met het recept (2 staal + 1 stok) of pak hem via creative. In creative kun je het icoon zoeken (halter) en eruit pakken.</li>
  <li><strong>Train je Strength:</strong> Houd de halter vast en klik rechts (alsof je hem gebruikt). Je zou een paar keer achter elkaar de halter “liften”. Iedere keer dat je dat doet, kijk naar de tekst: <strong>Strength: 1</strong>, dan <strong>Strength: 2</strong>, dan <strong>Strength: 3</strong>, … enz. Het getal neemt toe met elke use. Gefeliciteerd, je hebt een werkende strength counter!</li>
  <li><strong>Multiplayer check (indien mogelijk):</strong> Als je een tweede speler laat joinen (bijvoorbeeld via LAN of een tweede client), zal die ook een eigen Strength teller hebben, onafhankelijk. Als speler2 de halter gebruikt, zal alleen zijn/haar eigen Strength getal stijgen op diens scherm. Jouw teller blijft gelijk. Dit komt doordat we de values opslaan per naam en HUD per speler. (Je kunt dit wellicht testen in singleplayer moeilijk, maar vertrouw erop dat het per speler gaat.)</li>
  <li><strong>Opslaan bij leave (opmerking):</strong> In deze simpele versie reset Strength iedere keer je opnieuw joint (we zetten bij join op 0). Als je wilt, kun je proberen dat persistent te maken (dat is lastiger: je zou player meta moeten opslaan tussen sessies). Maar dat laten we nu zo; elke speelsessie train je opnieuw.</li>
  <li><strong>Leuke aankleding:</strong> Je zou bij het gebruik een geluid kunnen afspelen (bijv. een “uff” geluid) of een chatbericht “Poeh! Strength is nu X”. Dat hebben we niet gedaan, maar je kunt zelf toevoegen als oefening.</li>
</ol>

<h3 id="verwijzing-naar-documentatie-7">Verwijzing naar documentatie</h3>

<p>Dit hoofdstuk raakt aan:</p>
<ul>
  <li><strong>HUD API</strong>: zoek op <em>Minetest hud_add hud_change hud_remove</em> in de docs voor meer details. Er zijn ook hud_elem_types voor images, bars, etc.</li>
  <li><strong>Player meta</strong>: als je wilt dat Strength bewaard blijft per speler tussen sessies, kun je <code class="language-plaintext highlighter-rouge">player:set_meta("strength", waarde)</code> gebruiken en bij join <code class="language-plaintext highlighter-rouge">player:get_meta():get...</code>. Dit is wat geavanceerder (in de API docs onder ObjectRef metadata).</li>
  <li><strong>register_on_joinplayer</strong> en ook eventueel <strong>register_on_leaveplayer</strong> (we hebben leave niet gebruikt, maar handig om op te ruimen als het nodig was).</li>
  <li><strong>Craftitem on_use</strong>: we deden dat al eerder bij potions, hier herhaald.</li>
</ul>

<h3 id="oefeningen-7">Oefeningen</h3>

<p>Nu kun je dit concept uitbreiden of aanpassen:</p>

<ol>
  <li><strong>Startwaarde aanpassen:</strong> Laat nieuwe spelers misschien met Strength 5 beginnen in plaats van 0, of haal een opgeslagen waarde op als je dat implementeert.</li>
  <li><strong>Positie/uiterlijk HUD:</strong> Verplaats de Strength text naar een andere hoek of kleur. Probeer bijvoorbeeld linksboven in het scherm oranje te zetten. (Hint: position {x=0, y=0} is linksboven. number = 0xFF8800 zou een oranje kleur geven.)</li>
  <li><strong>Andere HUD element types:</strong> In plaats van tekst kun je ook een afbeelding als HUD elem doen. Bijvoorbeeld, toon een klein icoontje van een gewicht en de waarde ernaast. (Hiervoor kun je twee hud_add doen: één image, één text. Of nog mooier: er is een hud_elem_type “statbar” dat rijtjes van een icoon kan tonen, zoals de hartjes en bubbels doen. Je zou Strength kunnen presenteren als aantal “muscle” icoontjes. Dat is wat complexer, maar kijk in docs bij hud_elem_type.)</li>
  <li><strong>Beperk strength:</strong> Misschien wil je niet oneindig opschroeven. Voeg eens een maximum toe: als strength &gt;= 10, laat de hud_change niet verder gaan en geef een bericht “Je hebt het maximum bereikt!”. Dit vergt een simpele if in on_use.</li>
  <li><strong>Gebruik Strength ergens voor (verdieping):</strong> Op zich is een stat leuk, maar nog leuker als het invloed heeft. Kun je een manier bedenken om de Strength waarde te laten meespelen in iets? Bijvoorbeeld: je zou kunnen koppelen dat als Strength hoog is, je met de hand harder slaat of sneller graaft. Dat kan door in e.g. register_on_punchplayer event de damage te verhogen afhankelijk van de attacker’s Strength. Of je zou in een globalstep kunnen kijken naar Strength en de player:set_physics_override gebruiken om bij hoge Strength sneller te laten sprinten (kracht = snelheid?). Dit zijn moeilijke uitbreidingen, maar bedenk: een HUD stat kan dienen als basis voor rpg-achtige gameplay.</li>
  <li><strong>Persistente opslag (moeilijk):</strong> Probeer de tip over player meta-data: sla de Strength op zodat als je de wereld verlaat en terugkomt, je waarde niet weg is. (Je kunt in <code class="language-plaintext highlighter-rouge">on_leaveplayer</code> iets doen of direct in hud_change ook <code class="language-plaintext highlighter-rouge">player:get_meta():set_int("strength", player_strength[name])</code>. En in on_joinplayer lezen <code class="language-plaintext highlighter-rouge">player:get_meta():get_int("strength")</code> voor de start. Documentatie API “PlayerMetaRef” kan hierbij helpen.)</li>
</ol>

<p>Je hebt nu geleerd hoe je de interface kunt veranderen en informatie aan de speler tonen. Dit is al behoorlijk gevorderd modden, goed gedaan!</p>

<p>We hebben bijna alle onderwerpen behandeld die we ons voorgenomen hadden. Er is nog één praktisch onderdeel over: <strong>hoe speel je je mods samen met vrienden via LAN</strong>. Dat komt nu aan bod in het afsluitende hoofdstuk.</p>

<hr />

<h2 id="hoofdstuk-9-samen-spelen-via-local-area-network-lan">Hoofdstuk 9: Samen spelen via Local Area Network (LAN)</h2>

<p><strong>Wat ga je leren?</strong> In dit laatste hoofdstuk leggen we uit hoe je de door jou gemaakte mods kunt gebruiken in een multiplayerspel met anderen op jouw lokale netwerk (bijvoorbeeld thuis met broer/zus, op school met klasgenoten in hetzelfde wifi-netwerk). We beschrijven stap voor stap hoe je een LAN-spel host en laat anderen aansluiten. Het is geen code, maar wel handig om te weten zodat je de pret kunt delen!</p>

<h3 id="voorbereidingen">Voorbereidingen</h3>

<p>Zorg ervoor dat alle computers die mee willen spelen:</p>
<ul>
  <li>Op hetzelfde lokale netwerk zitten (bijv. dezelfde wifi of bedraad LAN).</li>
  <li>Dezelfde versie van Minetest/Luanti geïnstalleerd hebben.</li>
  <li>Jouw mods beschikbaar hebben of in elk geval dat de host ze heeft. <em>(Opmerking: in Minetest is het voldoende dat de server (host) de mods heeft; de clients krijgen automatisch de content. Maar het kan nuttig zijn dat iedereen de mods ook lokaal heeft, vooral als het media-delen traag is.)</em></li>
</ul>

<p>Beslis wie de <strong>host</strong> wordt (degene die de wereld “aanzet” waar anderen op inloggen). Dit is meestal de persoon die de wereld met de mods al heeft, bijvoorbeeld jijzelf als maker.</p>

<h3 id="wereld-instellen-en-hosten">Wereld instellen en hosten</h3>

<p>Volg deze stappen op de host-computer:</p>

<ol>
  <li><strong>Open Minetest en selecteer de wereld</strong> die je wilt gebruiken voor multiplayer. Dit kan een bestaande wereld zijn waar je mods al op actief zijn, of je maakt een nieuwe wereld en activeert de gewenste mods daarop.</li>
  <li>In het hoofdmenu, ga naar het tabblad <em>Start Game</em>. Kies je wereld.</li>
  <li>Aan de linkerkant zie je opties zoals <em>Creative Mode</em> en <em>Enable Damage</em>. Zorg dat deze naar wens staan (wil je creatieve mode aan of uit? damage aan voor survival?).</li>
  <li>Heel belangrijk: vink het hokje <strong>Host Server</strong> aan. Dit zorgt ervoor dat wanneer je de wereld start, het als multiplayer server draait.</li>
  <li>Kies een <strong>spelersnaam</strong> en <strong>wachtwoord</strong> voor jezelf als host, als je dat nog niet had. (Als je altijd Singleplayer speelde, let op: voor multiplayer kun je beter even een naam instellen in het Settings menu -&gt; Client -&gt; naam, of direct hier invullen. Het wachtwoord is om jouw speler te beveiligen zodat een ander op het netwerk niet onder jouw naam binnenkomt.)</li>
  <li>Klik nu op <strong>Play Game</strong> (Spel Starten). De wereld wordt geladen. Jij bevindt je nu in de wereld als host en de server luistert naar inkomende verbindi (<a href="https://commons.wikimedia.org/wiki/File:Minetest_Game_Main_Menu.png">File:Minetest Game Main Menu.png - Wikimedia Commons</a>)_image】 <em>Afbeelding: Het hoofdmenu van Minetest/Luanti. Om een LAN-server te starten selecteer je een wereld en vink je “Host Server” aan voordat je op “Play Game” klikt. Andere spelers gebruiken het “Join Game” tabblad om aan te sluiten.</em></li>
</ol>

<p>Wanneer het spel geladen is, zie je in je chat misschien een bericht zoals “Server running at 0.0.0.0:30000” of in de terminal/log iets van “Listening on port 30000”. Dit betekent dat de server draait.</p>

<h3 id="laten-aansluiten-joinen-via-lan">Laten aansluiten (joinen) via LAN</h3>

<p>Nu laat je de andere spelers verbinden:</p>

<ol>
  <li>De andere spelers starten Minetest op hun eigen computer.</li>
  <li>In het hoofdmenu gaan ze naar het tabblad <strong>Join Game</strong> (Multiplayer).</li>
  <li>Laat ze een spelersnaam invullen en een wachtwoord verzinnen. (Iedere speler moet een unieke naam hebben – dus niet allemaal “Player” want dat botst. Bijvoorbeeld gebruik jullie eigen voornamen of bijnamen.)</li>
  <li>Ze moeten nu het adres en poort van de server invoeren. Omdat jullie in hetzelfde lokale netwerk zitten, is dit het LAN-IP-adres van de hostcomputer en de poort (standaard 30000).
    <ul>
      <li>De poort is doorgaans <strong>30000</strong> (tenzij je dat in server settings veranderd hebt, maar standaard is 30000 goed).</li>
      <li>Het IP-adres van de host kun je vinden door op de hostcomputer in de netwerksettings te kijken. Vaak begint een lokaal IP met 192.168.x.x of 10.0.x.x. Bijvoorbeeld 192.168.1.5.</li>
      <li>Stel jouw host IP is 192.168.1.5, dan vullen de anderen bij <em>Address</em> in: <code class="language-plaintext highlighter-rouge">192.168.1.5</code> en bij <em>Port</em>: <code class="language-plaintext highlighter-rouge">30000</code>.</li>
      <li><strong>Tip:</strong> Soms verschijnt de LAN-server automatisch in het Join Game scherm onderin (Minetest kan lokale servers detecteren). Als ze daar een naam zien verschijnen (bijv. “Test Wereld [Minetest]”), kunnen ze die selecteren en de velden vullen zich in.</li>
    </ul>
  </li>
  <li>Als de naam, wachtwoord en adres/poort ingevuld zijn, klikken ze op <strong>Connect</strong> (Verbinden).</li>
  <li>De eerste keer kan het enkele seconden duren, vooral als er custom media (plaatjes van mods) gedownload moeten worden naar de spelers. Wacht geduldig; ze krijgen waarschijnlijk een “Media…” voortgangsbalkje terwijl textures van jouw mods worden binnengehaald. (Daarom is het handig dat jouw texturebestanden klein zijn, wat ze meestal wel zijn, of dat de andere spelers de mod al geïnstalleerd hebben lokaal zodat geen download nodig is.)</li>
  <li>Als alles goed gaat, verschijnen de andere spelers in jouw wereld! Je zult in jouw game zien “PlayerX joined the game.” En op hun scherm zijn ze nu in de wereld samen met jou.</li>
</ol>

<h3 id="samen-mods-beleven">Samen mods beleven</h3>

<p>Nu spelen jullie lokaal samen in de wereld. Alle mods die jij geactiveerd had in de wereld zijn nu actief voor iedereen. Enkele aandachtspunten/fun dingen:</p>
<ul>
  <li><strong>Check mods</strong>: Typ <code class="language-plaintext highlighter-rouge">/mods</code> in de chat; iedereen zal de lijst van actieve mods zien, waaronder de mods die je zelf gemaakt hebt. Cool hè?</li>
  <li><strong>Gebruik de mods samen</strong>: Probeer elkaar de items te geven en kijken of ze werken. Bijvoorbeeld:
    <ul>
      <li>Ruil de vliegen-potion en feather-fall potion uit en test of een ander er ook mee kan vliegen.</li>
      <li>Doe een PvP gevecht: de één met het regenboogzwaard, de ander met het teleportatiezwaard, of test de gravel armor door elkaar te slaan terwijl die aan staat.</li>
      <li>Bouw samen iets en gebruik de dirt-helm om het ’s nachts te verlichten voor iedereen.</li>
      <li>Misschien grappig: iemand met regenboogzwaard verandert blokken terwijl de ander probeert te bouwen, geeft een gek kleurfestijn.</li>
    </ul>
  </li>
  <li><strong>LAN stabiel houden</strong>: Zorg dat de host-computer niet te zwaar belast wordt. Als er lag optreedt (vertraging), kan het helpen als niet teveel andere programma’s draaien. Maar over het algemeen kan Minetest wel een paar spelers op een thuisnetwerk aan.</li>
  <li><strong>Opslaan en stoppen</strong>: Als jullie klaar zijn, kan de host gewoon het spel verlaten (Esc &gt; Save and Exit). De wereld wordt dan opgeslagen met alle veranderingen en iedereen wordt losgekoppeld. Andere spelers kunnen gewoon hun client sluiten of wachten tot “Server shut down” melding komt.</li>
  <li>Volgende keer kan je dezelfde stappen herhalen om verder te spelen.</li>
</ul>

<h3 id="problemen-oplossen">Problemen oplossen</h3>

<ul>
  <li><em>Kan niet verbinden:</em> Controleer het IP-adres goed. Het moet het lokale adres van de host zijn, niet bijv. 127.0.0.1 (dat is localhost voor hun eigen PC) en niet een internet IP (wan IP) want jullie zitten op LAN. In Windows kun je <code class="language-plaintext highlighter-rouge">ipconfig</code> in cmd doen om IPv4 Address te vinden. In Mac/Linux <code class="language-plaintext highlighter-rouge">ifconfig</code> of kijk in netwerkicoontje details.</li>
  <li><em>Firewall:</em> Soms blokkeert een firewall inkomende verbindingen. Als spelers de host niet kunnen bereiken, check de host’s firewall instellingen. Voeg eventueel een regel toe om Minetest (poort 30000) toe te staan op het lokale netwerk.</li>
  <li><em>Versie mismatch:</em> Zorg dat iedereen dezelfde Minetest/Luanti versie heeft. Verschillende versies kunnen soms niet compatibel zijn als er grote verschillen zijn.</li>
  <li><em>Mods niet actief:</em> Als iets van de mod niet werkt voor anderen, bedenk dat de server de logica runt. De clients krijgen alleen de visuele data. Dus als er toch iets niet werkt, kijk op de server (host) console voor eventuele errors van mods. Debug eventueel je mod.</li>
  <li><em>Te veel lag:</em> In een lokaal netwerk zal lag weinig zijn, behalve als de host-computer het niet aan kan. Verminder grafische settings of beperk aantal actieve mods als het een heel zwakke machine is.</li>
</ul>

<h3 id="oefeningen-8">Oefeningen</h3>

<p>Er is hier niet echt code om te veranderen, maar wel dingen om uit te proberen:</p>
<ol>
  <li><strong>Speel scenario’s:</strong> Verzín een speltype met de mods. Bijvoorbeeld een soort mini-game: wie het eerst 10 gekleurde wol-blokken verzamelt door regenboogzwaard te gebruiken, of een PvP wedstrijd waarbij alleen special swords zijn toegestaan.</li>
  <li><strong>Coöp bouwen:</strong> Bouw samen een kleurrijk huis en gebruik regenboogzwaard als schilderkwast. Laat iemand anders de kleuren “aanbrengen” terwijl jij blokken plaatst.</li>
  <li><strong>Mod debugging in MP:</strong> Provoceer bewust iets geks: wat als twee spelers tegelijk de halter gebruiken? Werkt ieders HUD goed? Wat als een speler de game joint die geen halter heeft en een andere wel hoge strength – ziet diegene zijn eigen 0 zonder issues? Dit soort tests kunnen je inzicht geven in hoe robuust je mod is.</li>
  <li><strong>LAN met meer dan lokaal:</strong> Dit gaat buiten LAN, maar als je ooit wilt dat iemand van buiten je netwerk meedoet (bijv. een vriend van verderweg via internet), moet je port-forwarding instellen op je router voor poort 30000. Dat is wat geavanceerder netwerkbeheer en niet altijd veilig; doe dat alleen als je weet wat je doet (en met ouder/toestemming als je jong bent). LAN is meestal makkelijk en veilig genoeg.</li>
</ol>

<hr />

<h2 id="afsluiting">Afsluiting</h2>

<p>Je hebt het einde van dit leerboek bereikt – fantastisch gedaan! 🎉 We hebben heel veel behandeld:</p>
<ul>
  <li>Inleiding in mods en een welkomstbericht mod.</li>
  <li>Crafting recepten toegevoegd (dirt -&gt; diamond).</li>
  <li>Magische potions gemaakt om te vliegen en langzaam te vallen.</li>
  <li>Een lichtgevende helm en een onschendbaar pantser geprogrammeerd.</li>
  <li>Twee supercoole speciale zwaarden bedacht en geïmplementeerd.</li>
  <li>Een eigen HUD statistiek uitgeprobeerd.</li>
  <li>Geleerd hoe je alles met vrienden op LAN kunt spelen.</li>
</ul>

<p>Hopelijk heb je gemerkt dat programmeren in Lua voor Minetest best leuk en goed te doen is, vooral als je stap-voor-stap voorbeelden volgt en vervolgens mee gaat experimenteren. Misschien heb je onderweg al je eigen twists gegeven aan de oefenopdrachten – supergoed! Zo leer je creatief denken als programmeur.</p>

<p>Natuurlijk is er nog véél meer te ontdekken in Minetest modding. Je kunt bijvoorbeeld leren hoe je eigen blokken met modellen of animaties maakt, hoe je vormen (nodes) kunt genereren, hoe je interactieve formspecs (venstertjes) maakt, of zelfs hoe je vijandige mob monsters of vriendelijke dieren kunt toevoegen via Lua. De mogelijkheden zijn eindeloos.</p>

<p>Belangrijk is dat je plezier houdt in het <em>doen</em>: proberen, fouten maken, oplossen, en iets nieuws laten werken. Als iets niet in één keer werkt, niet opgeven! Lees de foutmeldingen, zoek in de documentatie (zoekterm: <em>Minetest Modding API</em>), vraag eventueel hulp op forums (de Minetest community is er eentje van behulpzame mensen en mede-modders).</p>

<p>Je bent nu geen gewone speler meer, maar ook een <strong>maker</strong> binnen Minetest. Hoe gaaf is dat? Blijf oefenen en misschien schrijf je over een tijdje wel je eigen complete game-mode of publiceer je mods zodat anderen ze kunnen gebruiken.</p>

<p>Veel succes en vooral veel plezier met programmeren en spelen!</p>

<p><strong><em>Einde van het leerboek</em></strong></p>

  
</article>



  <hr class="dingbat related mb6" />










  <aside class="about related mt4 mb4" role="complementary">
    
    

<div class="author mt4">
  

  
    


<img
  
    src="/blog/assets/img/self.jfif"
  
  alt="Carlos Kelkboom"
  class="avatar"
  
  width="120"
  height="120"
  loading="lazy"
/>

  

  
  
  <h2  class="page-title hr-bottom">
    About
  </h2>

  <p>Hi, I’m Carlos, and I’ve been a software developer for over 20 years. I’ve learned a lot 
from blog posts, Stack Overflow, and YouTube, but I’ve never felt confident enough to share 
my knowledge and give back to the community.</p>

<p>This blog is my attempt to return the favor and give back to the community.</p>


  <div class="sidebar-social">
    <span class="sr-only">Social</span>
<ul>
  
    
    

    
    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://github.com/baudin999" title="GitHub" class="no-mark-external">
      <span class="icon-github"></span>
      <span class="sr-only">GitHub</span>
    </a>
  </li>


    

    
    
      



  

  
  
  
  

  

  

  <li>
    <a href="mailto:baudin-sky@pm.me" title="Email" class="no-mark-external">
      <span class="icon-mail"></span>
      <span class="sr-only">Email</span>
    </a>
  </li>


    
  
</ul>

  </div>
</div>

  </aside>











  <aside class="related mb4" role="complementary">  <h2 class="hr-bottom">Related Posts</h2>  <ul class="related-posts">                  <li class="h4">  <a href="/blog/2025/03/23/filter-theory-part-3.html" class="flip-title"><span>Filter Theory - A Simpler, More Elegant Approach to Consciousness</span></a>  <time class="faded fine" datetime="2025-03-23T00:00:00+01:00">23 Mar 2025</time></li>                        <li class="h4">  <a href="/blog/2025/03/23/filter-theory-part-2.html" class="flip-title"><span>From Filter Theory to Dreaming Machines - A Framework for Consciousness</span></a>  <time class="faded fine" datetime="2025-03-23T00:00:00+01:00">23 Mar 2025</time></li>                        <li class="h4">  <a href="/blog/2025/03/22/how-toscale-a-software-business.html" class="flip-title"><span>How to scale a Software business</span></a>  <time class="faded fine" datetime="2025-03-22T00:00:00+01:00">22 Mar 2025</time></li>            </ul></aside>













<!-- Utterances integration code starts here -->
<script src="https://utteranc.es/client.js" repo="Baudin999/blog" issue-term="pathname" theme="github-light"
    crossorigin="anonymous" async>
    </script>
<!-- Utterances integration code ends here -->
  
<footer class="content" role="contentinfo">
  <hr />
  <p><small>Powered by Baudin's playground v<span id="_version">1.0.0</span></small></p>
  <hr class="sr-only" />
</footer>

</main>

  <hy-drawer
  id="_drawer"
  class=""
  side="left"
  threshold="10"
  noscroll
  
>
  <header id="_sidebar" class="sidebar" role="banner">
    




<div class="sidebar-bg sidebar-overlay" style="background-color:rgb(45, 16, 9);background-image:url(/blog/assets/img/site_bg.jpg)"></div>

    <div class="sidebar-sticky">
  <div class="sidebar-about">
    
    <a class="sidebar-title" href="/blog/"><h2 class="h1">Carlos's Blog</h2></a>
    
    
      <p class="fine">
        I have been consuming the combined knowledge of my heroes for years. Now, after over 20 years as a software developer, I am ready to give back to everyone. I hope you enjoy!

      </p>
    
  </div>

  <nav class="sidebar-nav heading" role="navigation">
    <span class="sr-only">Navigation:</span>
<ul>
  
    
      
      <li>
        <a
          id="_drawer--opened"
          href="/blog/resume/"
          class="sidebar-nav-item "
          
        >
          Résumé
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/blog/about/"
          class="sidebar-nav-item "
          
        >
          About me
        </a>
      </li>
    
  
</ul>

  </nav>

  
  <div class="sidebar-social">
    <span class="sr-only">Social</span>
<ul>
  
    
    

    
    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://github.com/baudin999" title="GitHub" class="no-mark-external">
      <span class="icon-github"></span>
      <span class="sr-only">GitHub</span>
    </a>
  </li>


    

    
    
      



  

  
  
  
  

  

  

  <li>
    <a href="mailto:baudin-sky@pm.me" title="Email" class="no-mark-external">
      <span class="icon-mail"></span>
      <span class="sr-only">Email</span>
    </a>
  </li>


    
  
</ul>

  </div>
</div>
  </header>
</hy-drawer>
<hr class="sr-only" hidden />

</hy-push-state>


  <!--[if gt IE 10]><!---->
  <script nomodule>(()=>{var t,n=document.createElement("script");!("noModule"in n)&&"onbeforeload"in n&&(t=!1,document.addEventListener("beforeload",function(e){if(e.target===n)t=!0;else if(!e.target.hasAttribute("nomodule")||!t)return;e.preventDefault()},!0),n.type="module",n.src=".",document.head.appendChild(n),n.remove())})();
</script>
  <script src="/blog/assets/js/hydejack-9.2.1.js" type="module"></script>
  <script src="/blog/assets/js/LEGACY-hydejack-9.2.1.js" nomodule defer></script>
  

  

<!--<![endif]-->
  



<div hidden>
  
  <h2 class="sr-only">Templates:</h2>

  <template id="_animation-template">
  <div class="animation-main fixed-top">
    <nav id="breadcrumbs" class="screen-only"><ul>
  
  
</ul></nav>
    <div class="content">
      <div class="page"></div>
    </div>
  </div>
</template>

  <template id="_loading-template">
  <div class="loading nav-btn fr">
    <span class="sr-only">Loading…</span>
    <span class="icon-cog"></span>
  </div>
</template>

  <template id="_error-template">
  <div class="page">
    <h1 class="page-title">Error</h1>
    
    
    <p class="lead">
      Sorry, an error occurred while loading: <a class="this-link" href=""></a>.
    </p>
  </div>
</template>

  <template id="_permalink-template">
  <a href="#" class="permalink">
    <span class="sr-only">Permalink</span>
    <span class="content-hash"></span>
  </a>
</template>

  
    <template id="_dark-mode-template">
  <button id="_dark-mode" class="nav-btn no-hover" >
    <span class="sr-only">Dark Mode</span>
    <span class="icon-brightness-contrast"></span>
  </button>
</template>

  
</div>


</body>


</html>